import{r as i,j as e,q as w,$ as O}from"./app-eAIuj_cC.js";import{D as F,M as E,A}from"./AuthenticatedLayout-1Tl302_h.js";import{S as B,V as M,D as G,a as L,E as R,b as D}from"./ValidationErrorAlert-FS6RG0IT.js";import{d as C}from"./index-BQc1uWjq.js";import{C as V,T as s,I as $,a as q}from"./Close-yBam2o1_.js";import{u as H,T as U}from"./Typography-BcdJuq5C.js";import{B as h}from"./Box-BGLLKGRv.js";import{I as b}from"./IconButton-CrzczThT.js";import{B as W}from"./Button-DI9pIjvX.js";import{T as v}from"./Tooltip-69rEhds4.js";import"./isMuiElement-BN6hkxZ0.js";import"./Logout-Cp_TGwhv.js";import"./Paper-D99NRCdE.js";import"./Grow-DLqGqw0i.js";import"./Portal-Bp8leHfp.js";import"./Modal-CIXJXkbC.js";import"./useThemeProps-B-6moD8G.js";import"./Alert--jybFbC2.js";function J({open:m,onClose:g,student:r=null}){const j=new Date().toISOString().split("T")[0],p=H(),[n,c]=i.useState({name:"",email:"",password:"",birthdate:"",gender:"",phone:"",address:"",zip_code:"",city:"",country:"",school:"",expires_at:""});i.useEffect(()=>{var l,o,d,u;c(r?{name:((l=r.user)==null?void 0:l.name)||"",email:((o=r.user)==null?void 0:o.email)||"",password:"",birthdate:r.birthdate||"",gender:(r==null?void 0:r.gender)||"",phone:r.phone||"",address:r.address||"",zip_code:r.zip_code||"",city:r.city||"",country:r.country||"",school:r.school||"",expires_at:((u=(d=r.user)==null?void 0:d.paypal_user)==null?void 0:u.expires_at.substring(0,10))||""}:{name:"",email:"",password:"",birthdate:"",phone:"",address:"",zip_code:"",city:"",country:"",school:"",expires_at:""})},[r]);const t=l=>{const{name:o,value:d}=l.target;c(u=>({...u,[o]:d}))},y=l=>{l.preventDefault();const o={...n,role:"student"};r?C.Inertia.post(route("students.update",r.id),{...o,_method:"PUT"}):(console.log(o),C.Inertia.post(route("students.store"),o)),g()};return e.jsx(F,{anchor:"right",open:m,onClose:g,sx:{zIndex:p.zIndex.drawer+1},children:e.jsxs(h,{sx:{width:400,p:3},role:"presentation",children:[e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(U,{variant:"h6",children:r?"Editar Estudiante":"Nuevo Estudiante"}),e.jsx(b,{onClick:g,children:e.jsx(V,{})})]}),e.jsxs(h,{component:"form",onSubmit:y,mt:2,children:[e.jsx(s,{fullWidth:!0,label:"Nombre",name:"name",value:n.name,onChange:t,margin:"normal"}),e.jsx(s,{fullWidth:!0,label:"Correo electrónico",name:"email",type:"email",value:n.email,onChange:t,margin:"normal"}),e.jsx(s,{fullWidth:!0,label:"Contraseña",name:"password",type:"password",value:n.password,onChange:t,margin:"normal",helperText:r?"Deja en blanco si no deseas cambiar la contraseña":""}),e.jsx(s,{fullWidth:!0,label:"Fecha de nacimiento",name:"birthdate",type:"date",value:n.birthdate,onChange:t,margin:"normal",InputLabelProps:{shrink:!0},inputProps:{max:j}}),e.jsx($,{id:"gender-label",children:"Género"}),e.jsxs(q,{fullWidth:!0,name:"gender",value:n.gender||"",label:"Género",onChange:t,children:[e.jsx(E,{value:"Masculino",children:"Masculino"}),e.jsx(E,{value:"Femenino",children:"Femenino"}),e.jsx(E,{value:"Otro",children:"Otro"})]}),e.jsx(s,{fullWidth:!0,label:"Teléfono",name:"phone",value:n.phone,onChange:t,margin:"normal"}),e.jsx(s,{fullWidth:!0,label:"Dirección",name:"address",value:n.address,onChange:t,margin:"normal"}),e.jsx(s,{fullWidth:!0,label:"CP",name:"zip_code",value:n.zip_code,onChange:t,margin:"normal"}),e.jsx(s,{fullWidth:!0,label:"Ciudad",name:"city",value:n.city,onChange:t,margin:"normal"}),e.jsx(s,{fullWidth:!0,label:"Pais",name:"country",value:n.country,onChange:t,margin:"normal"}),e.jsx(s,{fullWidth:!0,label:"Escuela",name:"school",value:n.school,onChange:t,margin:"normal"}),e.jsx(s,{fullWidth:!0,label:"Fecha de expiración",name:"expires_at",type:"date",value:n.expires_at,onChange:t,margin:"normal",InputLabelProps:{shrink:!0},inputProps:{min:j}}),e.jsx(W,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},children:r?"Actualizar":"Crear"})]})]})})}function me(){var S,_;const{errors:m,flash:g}=w().props,{students:r}=w().props,[j,p]=i.useState(!1),[n,c]=i.useState(null),t=((_=(S=w().props)==null?void 0:S.flash)==null?void 0:_.success)??null,[y,l]=i.useState(!!t),[o,d]=i.useState(!1);i.useEffect(()=>{t&&l(!0)},[t]),i.useEffect(()=>{Object.keys(m).length>0&&d(!0)},[m]);const u=a=>{c(a),p(!0)},T=()=>{c(null),p(!0)},z=a=>{confirm("¿Estás seguro de eliminar este estudiante?")&&C.Inertia.delete(route("students.destroy",a))},P=a=>{confirm("¿Estás seguro de recuperar este estudiante?")&&C.Inertia.put(route("students.restore",a))},k=[{field:"id",headerName:"ID",width:40},{field:"name",headerName:"Nombre",flex:1},{field:"user_email",headerName:"Correo",flex:1.5,renderCell:a=>{var x,f;return((f=(x=a==null?void 0:a.row)==null?void 0:x.user)==null?void 0:f.email)||""}},{field:"birthdate",headerName:"Fecha Nacimiento",flex:1},{field:"gender",headerName:"Género",flex:1},{field:"phone",headerName:"Teléfono",flex:1},{field:"address",headerName:"Direccion",flex:1},{field:"zip_code",headerName:"CP",flex:1},{field:"city",headerName:"Ciudad",flex:1},{field:"country",headerName:"País",flex:1},{field:"school",headerName:"Escuela",flex:1},{field:"user_expires_at",headerName:"Fecha Expiración",flex:1,renderCell:a=>{var f,I,N;const x=(N=(I=(f=a==null?void 0:a.row)==null?void 0:f.user)==null?void 0:I.paypal_user)==null?void 0:N.expires_at;return x?x.substring(0,10):""}},{field:"actions",headerName:"Acciones",width:120,sortable:!1,renderCell:a=>e.jsxs(L,{direction:"row",spacing:1,children:[e.jsx(v,{title:"Editar",children:e.jsx(b,{onClick:()=>u(a.row),color:"primary",children:e.jsx(R,{})})}),a.row.deleted_at?e.jsx(v,{title:"Recuperar",children:e.jsx(b,{onClick:()=>P(a.row.id),color:"success",children:e.jsx(D,{})})}):e.jsx(v,{title:"Eliminar",children:e.jsx(b,{onClick:()=>z(a.row.id),color:"error",children:e.jsx(D,{})})})]})}];return e.jsxs(A,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Estudiantes"}),children:[e.jsx(O,{title:"Estudiantes"}),e.jsx(B,{open:y,onClose:()=>l(!1),message:t}),e.jsx(M,{open:o,onClose:()=>d(!1),errors:m}),e.jsxs(h,{p:4,children:[e.jsx(h,{display:"flex",justifyContent:"flex-end",mb:2,children:e.jsx(W,{variant:"contained",color:"primary",onClick:T,children:"Crear nuevo estudiante"})}),e.jsx(h,{sx:{height:600,width:"100%"},children:e.jsx(G,{rows:r,columns:k,pageSize:10,rowsPerPageOptions:[5,10,20],disableSelectionOnClick:!0,getRowId:a=>a.id,autoHeight:!0})})]}),e.jsx(J,{open:j,onClose:()=>p(!1),student:n})]})}export{me as default};
