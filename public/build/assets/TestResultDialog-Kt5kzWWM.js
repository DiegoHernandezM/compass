import{r as o,j as e}from"./app-BEt_j3y4.js";import{u as I,C as E,T as f}from"./Modal-lD_zqTbe.js";import{u as B,S as M}from"./index-DazhPLGl.js";import{D as w}from"./Dialog-CJdmGbGA.js";import{B as a}from"./Box-Dr-7W-DA.js";import{D as R,a as W,b as L}from"./DialogTitle-CjaMSVqh.js";import{B as k}from"./Button-CzMRS666.js";const P="/build/assets/result_video-BNB9BkEU.mp4",z=o.forwardRef(function(c,d){return e.jsx(M,{direction:"up",ref:d,...c})});function Y({open:r,onClose:c,correct:d=0,total:m=0,onGoToSubjects:C,showReview:D}){const l=I(),h=B(l.breakpoints.down("sm")),n=m>0?Math.round(d/m*100):0,[u,v]=o.useState(0),[S,g]=o.useState(0),j=o.useRef(null),y=u<60?l.palette.error.main:u<80?l.palette.warning.main:l.palette.success.main;let p="";return n>=90?p="¡Excelente resultado!":n>=70?p="¡Bien hecho!":p="Necesitas mejorar, sigue practicando.",o.useEffect(()=>{if(!r)return;v(0),g(0);const t=1200,s=16,i=Math.ceil(t/s);let x=0;const b=setInterval(()=>{x+=1;const T=Math.min(n,Math.round(x/i*n));v(T),g(T),x>=i&&clearInterval(b)},s);return()=>clearInterval(b)},[r,n]),o.useEffect(()=>{const t=j.current;if(!t)return;let s,i;if(r)t.muted=!0,t.playsInline=!0,s=async()=>{try{t.currentTime=1,await t.play()}catch{}},t.readyState>=1?s():t.addEventListener("loadedmetadata",s,{once:!0}),i=()=>{t.currentTime>=5&&(t.pause(),t.removeEventListener("timeupdate",i))},t.addEventListener("timeupdate",i);else try{t.pause()}catch{}return()=>{s&&t.removeEventListener("loadedmetadata",s),i&&t.removeEventListener("timeupdate",i)}},[r]),e.jsxs(w,{open:r,onClose:c,fullWidth:!0,maxWidth:"xs",TransitionComponent:z,scroll:"paper",PaperProps:{sx:{m:h?0:2,borderRadius:h?0:3,position:"relative",backgroundColor:"transparent",display:"flex",flexDirection:"column",maxHeight:"100dvh",overflow:"hidden"}},children:[e.jsx(a,{sx:{position:"absolute",inset:0,zIndex:0,opacity:1,pointerEvents:"none"},children:e.jsx("video",{ref:j,src:P,muted:!0,playsInline:!0,autoPlay:!0,preload:"auto",style:{width:"100%",height:"100%",objectFit:"cover"}},r?"open":"closed")}),e.jsxs(a,{sx:{position:"relative",zIndex:1,backgroundColor:"rgba(255,255,255,0.90)",display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx(R,{sx:{fontWeight:700,pb:1},children:"¡Test terminado!"}),e.jsx(W,{dividers:!1,sx:{flex:1,overflowY:"auto",pt:1,pb:2},children:e.jsxs(a,{sx:{display:"grid",placeItems:"center",my:{xs:4,sm:8,md:10}},children:[e.jsxs(a,{sx:{position:"relative",display:"inline-flex"},children:[e.jsx(E,{variant:"determinate",value:100,size:140,thickness:5,sx:{color:l.palette.action.disabledBackground,position:"absolute",left:0}}),e.jsx(E,{variant:"determinate",value:u,size:140,thickness:5,sx:{color:y}}),e.jsx(a,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",color:y},children:e.jsxs(f,{variant:"h4",sx:{fontWeight:800},children:[u,"%"]})})]}),e.jsxs(a,{sx:{textAlign:"center"},children:[e.jsxs(f,{variant:"h6",sx:{mt:2,fontWeight:700},children:[d," de ",m]}),e.jsxs(f,{variant:"overline",color:"text.secondary",sx:{mt:.5},children:[e.jsx("strong",{children:p})," Tu porcentaje es ",n,"%."]})]})]})}),e.jsxs(L,{sx:{px:3,pb:2,gap:1,position:"sticky",bottom:0,left:0,right:0,zIndex:2,bgcolor:"rgba(255,255,255,0.92)",backdropFilter:"saturate(180%) blur(6px)"},children:[D?e.jsx(k,{variant:"contained",onClick:c,fullWidth:!0,children:"Revisar"}):null,e.jsx(k,{variant:"contained",onClick:C,color:"primary",fullWidth:!0,children:"Materias"})]})]})]})}export{Y as T};
