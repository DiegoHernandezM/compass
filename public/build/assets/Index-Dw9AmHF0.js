import{r as i,j as e,a as te,q as U,$ as we}from"./app-DR2zBp-L.js";import{d as L}from"./index-Dec7CTD8.js";import{V as re}from"./VisibilityOff-AmBwGc6M.js";import{I as ve,A as _e}from"./index-CgG0yc6_.js";import{E as se,D as Ie}from"./Edit-CQKS-x8r.js";import{D as G,A as Se}from"./AuthenticatedLayout-gi5zkpjh.js";import{C as V}from"./Close-Co9ANK6l.js";import{B as h}from"./Box-B9u98YDw.js";import{T,B as ke,C as De}from"./Modal-CRrWWUgi.js";import{I as k}from"./Alert-DvJxy-xn.js";import{T as C,F as N,I as P,S as W}from"./TextField-lpAxU7BV.js";import{M as v,A as Ne,T as Ee}from"./ErrorAlert-DCBbolGV.js";import{B as w}from"./Button-OQKuQoda.js";import{D as R}from"./Dialog-D3QxleVS.js";import{D as z,a as Q,b as M}from"./DialogTitle-C9EyRGxo.js";import{F as Te}from"./FormGroup-CMzGgGGA.js";import{F as We,S as K}from"./Stack-B441S073.js";import{C as Fe,D as H,T as y,a as Ae}from"./DataGrid-CKzorQPA.js";import{S as Le,V as ye}from"./ValidationErrorAlert-BLCi1ZWN.js";import{S as Pe}from"./Slide-D9XNXjGy.js";import"./createSvgIcon-CZbv8gad.js";import"./School-B4DAwMVy.js";import"./Person-D41LmTHu.js";import"./MenuBook-DYL1hG-j.js";import"./Logout-DdC8_0_w.js";import"./isMuiElement-CeqTiZPQ.js";import"./index-1-lfV_IU.js";import"./getThemeProps-Sn2k6trT.js";import"./index-BDNgXLEW.js";import"./useFormControl-CuErMVQB.js";import"./useThemeProps-CDjvlXDC.js";import"./index-DcbLWFTz.js";import"./LinearProgress-DTq8upgn.js";import"./TableCell-CBKigoLH.js";function Re({open:g,onClose:c,question:n=null}){const[a,m]=i.useState({question:"",answer_a:"",answer_b:"",answer_c:"",answer_d:"",correct_answer:"",feedback_text:"",feedback_image:null});i.useEffect(()=>{m({question:(n==null?void 0:n.question)||"",answer_a:(n==null?void 0:n.answer_a)||"",answer_b:(n==null?void 0:n.answer_b)||"",answer_c:(n==null?void 0:n.answer_c)||"",answer_d:(n==null?void 0:n.answer_d)||"",correct_answer:(n==null?void 0:n.correct_answer)||"",feedback_text:(n==null?void 0:n.feedback_text)||"",feedback_image:null,has_dynamic:(n==null?void 0:n.has_dynamic)||!1})},[n]);const s=l=>{const{name:j,type:t,files:r,value:d,checked:p}=l.target,b=t==="file"?r[0]:t==="checkbox"?p:d;m(_=>({..._,[j]:b}))},f=l=>{l.preventDefault();const j={...a};L.Inertia.post(route("question.update",n.id),{...j,_method:"PUT"},{forceFormData:!0}),c()};return e.jsx(G,{anchor:"right",open:g,onClose:c,sx:{zIndex:l=>l.zIndex.drawer+1e3},children:e.jsxs(h,{sx:{width:400,p:3},role:"presentation",children:[e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(T,{variant:"h6",children:n?"Editar Pregunta":"Nueva Pregunta"}),e.jsx(k,{onClick:c,children:e.jsx(V,{})})]}),e.jsxs(h,{component:"form",onSubmit:f,mt:2,children:[e.jsx(C,{label:"Pregunta",name:"question",fullWidth:!0,value:a.question,onChange:s,margin:"normal",required:!0}),e.jsx(C,{label:"Respuesta A",name:"answer_a",fullWidth:!0,value:a.answer_a,onChange:s,margin:"normal",required:!0}),e.jsx(C,{label:"Respuesta B",name:"answer_b",fullWidth:!0,value:a.answer_b,onChange:s,margin:"normal",required:!0}),e.jsx(C,{label:"Respuesta C",name:"answer_c",fullWidth:!0,value:a.answer_c,onChange:s,margin:"normal",required:!0}),e.jsx(C,{label:"Respuesta D",name:"answer_d",fullWidth:!0,value:a.answer_d,onChange:s,margin:"normal"}),e.jsxs(N,{fullWidth:!0,margin:"normal",required:!0,children:[e.jsx(P,{id:"correct-answer-label",children:"Respuesta Correcta"}),e.jsxs(W,{labelId:"correct-answer-label",name:"correct_answer",value:a.correct_answer,label:"Respuesta Correcta",onChange:s,MenuProps:{container:document.body,disablePortal:!0},children:[e.jsx(v,{value:"A",children:"A"}),e.jsx(v,{value:"B",children:"B"}),e.jsx(v,{value:"C",children:"C"}),e.jsx(v,{value:"D",children:"D"})]})]}),e.jsx(C,{label:"Retroalimentación",name:"feedback_text",fullWidth:!0,multiline:!0,rows:3,value:a.feedback_text,onChange:s,margin:"normal"}),e.jsx("input",{type:"file",name:"feedback_image",onChange:s,style:{marginTop:16}}),e.jsx(w,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},children:"Actualizar"})]})]})})}function Oe({open:g,onClose:c,question:n=null}){console.log(n);const[a,m]=i.useState({question:"",option_a:"",option_b:"",option_c:"",answer:""});i.useEffect(()=>{m({question:n.question||"",option_a:n.option_a||"",option_b:n.option_b||"",option_c:n.option_c||"",answer:n.answer||""})},[n]);const s=l=>{const{name:j,type:t,files:r,value:d,checked:p}=l.target,b=t==="file"?r[0]:t==="checkbox"?p:d;m(_=>({..._,[j]:b}))},f=l=>{l.preventDefault();const j={...a};L.Inertia.post(route("question-multitask.update",n.id),{...j,_method:"PUT"}),c()};return e.jsx(G,{anchor:"right",open:g,onClose:c,sx:{zIndex:l=>l.zIndex.drawer+1e3},children:e.jsxs(h,{sx:{width:400,p:3},role:"presentation",children:[e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(T,{variant:"h6",children:"Editar Pregunta"}),e.jsx(k,{onClick:c,children:e.jsx(V,{})})]}),e.jsxs(h,{component:"form",onSubmit:f,mt:2,children:[e.jsx(C,{label:"Pregunta",name:"question",fullWidth:!0,value:a.question,onChange:s,margin:"normal",required:!0}),e.jsx(C,{label:"Respuesta A",name:"option_a",fullWidth:!0,value:a.option_a,onChange:s,margin:"normal",required:!0}),e.jsx(C,{label:"Respuesta B",name:"option_b",fullWidth:!0,value:a.option_b,onChange:s,margin:"normal",required:!0}),e.jsx(C,{label:"Respuesta C",name:"option_c",fullWidth:!0,value:a.option_c,onChange:s,margin:"normal"}),e.jsxs(N,{fullWidth:!0,margin:"normal",required:!0,children:[e.jsx(P,{id:"correct-answer-label",children:"Respuesta Correcta"}),(n==null?void 0:n.type)=="figure"?e.jsxs(W,{labelId:"correct-answer-label",name:"answer",value:a.answer,label:"Respuesta Correcta",onChange:s,MenuProps:{container:document.body,disablePortal:!0},children:[e.jsx(v,{value:"x1",children:"x1"}),e.jsx(v,{value:"x2",children:"x2"}),e.jsx(v,{value:"x3",children:"x3"})]}):e.jsxs(W,{labelId:"correct-answer-label",name:"answer",value:a.answer,label:"Respuesta Correcta",onChange:s,MenuProps:{container:document.body,disablePortal:!0},children:[e.jsx(v,{value:"Incorrecto",children:"Incorrecto"}),e.jsx(v,{value:"Correcto",children:"Correcto"})]})]}),e.jsx(w,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},children:"Actualizar"})]})]})})}function ze({open:g,onClose:c,type:n,subjects:a,onSave:m}){const[s,f]=i.useState(""),[l,j]=i.useState(""),t=a.find(o=>o.id===Number(s)),r=(n==null?void 0:n.levels)||[],d=r.find(o=>o.id===Number(l)),[p,b]=i.useState(!1),[_,S]=i.useState(""),[I,u]=i.useState(""),D=(n==null?void 0:n.bypass_levels_and_questions)===1,[$,E]=i.useState(!1);i.useEffect(()=>{(async()=>{var O;if(s&&l)try{const F=await te.get(`/admin/question/check-existence/${s}/${l}/${n==null?void 0:n.id}`);((O=F.data)==null?void 0:O.exists.length)>0&&(console.log(F.data.exists),E(!0))}catch(F){console.error("Error al verificar test existente:",F)}})()},[s,l]);const q=()=>{if(n!=null&&n.id&&s){const o=new FormData;o.append("subject_id",s),o.append("question_type_id",n==null?void 0:n.id),o.append("question_level_id",l),o.append("question_count",_),o.append("has_time_limit",p?"1":"0"),p&&o.append("time_limit",I),m(o),f(""),j(""),S(""),u(""),c()}};return e.jsxs(e.Fragment,{children:[e.jsxs(R,{open:g,onClose:(o,O)=>{},fullWidth:!0,maxWidth:"xl",disableEscapeKeyDown:!0,children:[e.jsxs(z,{children:["Tipo de cuestionario: ",n==null?void 0:n.name]}),e.jsx(Q,{children:e.jsxs(h,{sx:{mt:2},children:[e.jsxs(N,{fullWidth:!0,margin:"normal",children:[e.jsx(P,{id:"type-select-label",children:"Materias"}),e.jsx(W,{labelId:"type-select-label",value:s??"",label:"Materias",onChange:o=>{f(o.target.value),j("")},required:!0,children:a.map(o=>e.jsx(v,{value:o.id,children:o.name},o.id))})]}),e.jsxs(N,{fullWidth:!0,margin:"normal",disabled:r.length==0,children:[e.jsx(P,{id:"level-select-label",children:"Nivel de complejidad"}),e.jsx(W,{labelId:"level-select-label",value:l??"",label:"Nivel de complejidad",onChange:o=>j(o.target.value),required:r.length>0,children:r.map(o=>e.jsxs(v,{value:o.id,children:[o.name," - ",o.description]},o.id))})]}),(d||D)&&e.jsxs(N,{fullWidth:!0,margin:"normal",children:[e.jsx(T,{variant:"subtitle1",component:"p",children:D?"Número de preguntas para el examen":`Preguntas disponibles sobre examen (${d?d.questions_count||0:(t==null?void 0:t.questions_count)||0})`}),e.jsx(C,{id:"count-question-required",label:"Número de preguntas para examen",type:"number",inputProps:{min:1,...D?{}:{max:d?d.questions_count:(t==null?void 0:t.questions_count)||1}},onChange:o=>S(o.target.value),required:!0})]}),D||s&&e.jsx(Te,{children:e.jsx(We,{control:e.jsx(Fe,{checked:p,onChange:o=>b(o.target.checked)}),label:"Tiempo límite"})}),p&&e.jsx(e.Fragment,{children:e.jsx(N,{fullWidth:!0,margin:"normal",children:e.jsx(C,{id:"limit-time-required",label:"Tiempo límite (segundos por pregunta)",type:"number",onChange:o=>u(o.target.value),inputProps:{min:1}})})})]})}),e.jsxs(M,{children:[e.jsx(w,{onClick:()=>{c(),f(""),l("")},children:"Cancelar"}),e.jsx(w,{variant:"contained",onClick:q,disabled:!s,children:"Crear"})]})]}),e.jsxs(R,{open:$,onClose:()=>E(!1),children:[e.jsx(z,{children:"Existen preguntas asignadas a esta materia"}),e.jsx(Q,{children:"Al continuar se reasignarán las nuevas preguntas a la materia con el nivel asignado. ¿Quieres continuar?"}),e.jsxs(M,{children:[e.jsx(w,{onClick:()=>E(!1),children:"Cancelar"}),e.jsx(w,{onClick:()=>{E(!1)},autoFocus:!0,children:"Continuar"})]})]})]})}function Qe({open:g,onClose:c,types:n,onImport:a,handleExport:m}){const[s,f]=i.useState(""),[l,j]=i.useState(null),[t,r]=i.useState(""),[d,p]=i.useState(""),b=n.find(u=>u.id===Number(t)),_=(b==null?void 0:b.levels)||[],S=u=>{j(u.target.files[0])},I=()=>{if(l&&t){const u=new FormData;u.append("file",l),u.append("type_id",t),u.append("level_id",d),a(u),j(null),setTypetId(""),setLeveltId(""),c()}};return e.jsxs(R,{open:g,onClose:c,fullWidth:!0,maxWidth:"sm",children:[e.jsx(z,{children:"Importar a banco de preguntas"}),e.jsx(Q,{children:e.jsxs(h,{sx:{mt:2},children:[e.jsxs(N,{fullWidth:!0,margin:"normal",children:[e.jsx(P,{id:"type-select-label",children:"Tipo de cuestionario"}),e.jsx(W,{labelId:"type-select-label",value:t,label:"Tipo de cuestionario",onChange:u=>{r(u.target.value),p("")},required:!0,children:n.filter(u=>u.is_automatic===0).map(u=>e.jsx(v,{value:u.id,children:u.name},u.id))})]}),e.jsxs(N,{fullWidth:!0,margin:"normal",disabled:!_.length,children:[e.jsx(P,{id:"level-select-label",children:"Nivel de complejidad"}),e.jsx(W,{labelId:"level-select-label",value:d,label:"Nivel de complejidad",onChange:u=>p(u.target.value),required:!0,children:_.map(u=>e.jsxs(v,{value:u.id,children:[u.name," - ",u.description]},u.id))})]}),e.jsxs(w,{variant:"outlined",component:"label",fullWidth:!0,sx:{mt:2},children:["Seleccionar archivo Excel",e.jsx("input",{type:"file",hidden:!0,accept:".xlsx, .xls",onChange:S})]}),l&&e.jsx(C,{label:"Archivo seleccionado",value:l.name,fullWidth:!0,disabled:!0,margin:"normal"})]})}),e.jsxs(M,{children:[e.jsx(w,{onClick:()=>{m(s),f(null)},children:"Exportar Concentrado"}),e.jsx(w,{onClick:()=>{c(),r(null),p(null)},children:"Cancelar"}),e.jsx(w,{variant:"contained",onClick:I,disabled:!l||!t,children:"Importar"})]})]})}function Me({open:g,onClose:c,type:n,handleSowQuestions:a}){const m=[{field:"name",headerName:"Nivel",flex:.1},{field:"description",headerName:"Descripción",flex:.5},{field:"actions",headerName:"Acciones",flex:.2,sortable:!1,renderCell:s=>e.jsx(K,{direction:"row",spacing:1,children:e.jsx(y,{title:"Ver preguntas",arrow:!0,children:e.jsx(k,{onClick:()=>a(s.row),color:"primary",children:e.jsx(re,{})})})})}];return e.jsxs(R,{open:g,onClose:c,fullWidth:!0,maxWidth:"md",children:[e.jsxs(z,{children:["Niveles de: ",n==null?void 0:n.name]}),e.jsx(Q,{children:e.jsx(h,{sx:{height:400,width:"100%"},children:e.jsx(H,{rows:n==null?void 0:n.levels,columns:m,pageSize:5,rowsPerPageOptions:[5],getRowId:s=>s.id})})}),e.jsx(M,{children:e.jsx(w,{onClick:c,children:"Cerrar"})})]})}const Be=i.forwardRef(function(c,n){return e.jsx(Pe,{direction:"up",ref:n,...c})});function Ve({open:g,close:c,questions:n,type:a,handleEditQuestion:m}){const s=t=>{if(typeof t!="string")return!1;const r=t.trim().toLowerCase();return r.startsWith("data:image/")||/\.(png|jpe?g|gif|svg|webp)$/.test(r)},f=t=>t?t.startsWith("http")||t.startsWith("data:")?t:`undefined/${t}`:"",l=[{field:"name",headerName:"Memorama",flex:.9,sortable:!0,renderCell:t=>{const r=ve[t.row.name];return r?e.jsx(r,{sx:{fontSize:40,color:"#555",mx:"auto"}}):e.jsx("span",{children:t.row.name})}}],j=[{field:"question",headerName:"Pregunta",flex:.9,sortable:!0,renderCell:t=>t.row.question?e.jsx(y,{title:t.row.question,arrow:!0,children:e.jsx("span",{style:{cursor:"default"},children:t.row.question})}):e.jsx(h,{component:"img",src:t.row.question_image,alt:"Pregunta",sx:{width:300,height:"auto",objectFit:"contain"}})},{field:"answer_a",headerName:"Opción A",flex:.9,sortable:!0,renderCell:({row:t})=>{if(t.question){const d=t.answer_a??t.option_a??"";return e.jsx("span",{children:d||"-"})}const r=t.answer_a??t.option_a??"";return r?s(r)?e.jsx(h,{sx:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(h,{component:"img",src:f(r),alt:"Respuesta A",sx:{width:25,height:25,objectFit:"contain"}})}):e.jsx("span",{children:r}):e.jsx("span",{children:"-"})}},{field:"answer_b",headerName:"Opción B",flex:.9,sortable:!0,renderCell:({row:t})=>{if(t.question){const d=t.answer_b??t.option_b??"";return e.jsx("span",{children:d||"-"})}const r=t.answer_b??t.option_b??"";return r?s(r)?e.jsx(h,{sx:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(h,{component:"img",src:f(r),alt:"Respuesta B",sx:{width:25,height:25,objectFit:"contain"}})}):e.jsx("span",{children:r}):e.jsx("span",{children:"-"})}},{field:"answer_c",headerName:"Opción C",flex:.9,sortable:!0,renderCell:({row:t})=>{if(t.question){const d=t.answer_c??t.option_c??"";return e.jsx("span",{children:d||"-"})}const r=t.answer_c??t.option_c??"";return r?s(r)?e.jsx(h,{sx:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(h,{component:"img",src:f(r),alt:"Respuesta C",sx:{width:25,height:25,objectFit:"contain"}})}):e.jsx("span",{children:r}):e.jsx("span",{children:"-"})}},{field:"answer_d",headerName:"Opción D",flex:.9,sortable:!0,renderCell:({row:t})=>{if(t.question){const d=t.answer_d??t.option_d??"";return e.jsx("span",{children:d||"-"})}const r=t.answer_d??t.option_d??"";return r?s(r)?e.jsx(h,{sx:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(h,{component:"img",src:f(r),alt:"Respuesta D",sx:{width:25,height:25,objectFit:"contain"}})}):e.jsx("span",{children:r}):e.jsx("span",{children:"-"})}},{field:"correct_answer",headerName:"Respuesta",flex:.9,sortable:!0,renderCell:t=>e.jsx("span",{children:t.row.correct_answer??t.row.answer})},{field:"actions",headerName:"Acciones",flex:.5,sortable:!0,renderCell:t=>e.jsx(K,{direction:"row",spacing:1,children:e.jsx(y,{title:"Editar",arrow:!0,children:e.jsx(k,{onClick:()=>m(t.row,a==null?void 0:a.name),color:"primary",children:e.jsx(se,{})})})})}];return e.jsx(i.Fragment,{children:e.jsxs(R,{fullScreen:!0,open:g,onClose:c,slots:{transition:Be},children:[e.jsx(Ne,{sx:{position:"relative"},children:e.jsxs(Ee,{children:[e.jsx(k,{edge:"start",color:"inherit",onClick:c,"aria-label":"close",children:e.jsx(V,{})}),e.jsx(T,{sx:{ml:2,flex:1},variant:"h6",component:"div",children:a==null?void 0:a.name}),e.jsx(w,{autoFocus:!0,color:"inherit",onClick:c,children:"CERRAR"})]})}),e.jsx(h,{p:4,children:e.jsx(h,{sx:{height:500,width:"100%"},children:e.jsx(H,{rows:n,columns:(a==null?void 0:a.bypass_levels_and_questions)!=1?j:l,pageSize:10,rowsPerPageOptions:[5,10,20],disableSelectionOnClick:!0,autoHeight:!0})})})]})})}function $e({open:g,onClose:c,levels:n=[],onChange:a}){const[m,s]=i.useState([]);i.useEffect(()=>{s(n||[])},[n]);const f=(t,r,d)=>{const p=[...m];p[t][r]=d,s(p),a(p)},l=()=>{const t={id:`new-${Date.now()}`,name:"",description:"",question_type_id:1},r=[...m,t];s(r),a(r)},j=t=>{if(m.length<=1)return;const r=[...m];r.splice(t,1),s(r),a(r)};return e.jsxs(R,{open:g,onClose:c,fullWidth:!0,maxWidth:"sm",slotProps:{backdrop:{sx:{zIndex:t=>t.zIndex.drawer+2001}}},PaperProps:{sx:{zIndex:t=>t.zIndex.drawer+2002}},children:[e.jsx(z,{children:"Editar Niveles"}),e.jsxs(Q,{dividers:!0,children:[m.length===0&&e.jsx(T,{variant:"body2",sx:{mt:1},children:"No hay niveles registrados."}),m.map((t,r)=>e.jsxs(h,{sx:{mt:2},children:[r!==0&&e.jsx(Ae,{sx:{my:2}}),e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(T,{variant:"subtitle1",children:"NIVEL"}),e.jsx(k,{color:"error",onClick:()=>j(r),disabled:m.length<=1,children:e.jsx(Ie,{})})]}),e.jsx(C,{label:"Nombre",fullWidth:!0,value:t.name,onChange:d=>f(r,"name",d.target.value),sx:{mb:1}}),e.jsx(C,{label:"Descripción",fullWidth:!0,value:t.description,onChange:d=>f(r,"description",d.target.value)})]},t.id||r)),e.jsx(w,{variant:"outlined",onClick:l,sx:{mt:3},children:"Agregar nivel"})]}),e.jsx(M,{children:e.jsx(w,{onClick:c,children:"Cerrar"})})]})}function qe({open:g,onClose:c,type:n=null,onSubmit:a}){const[m,s]=i.useState(!1),[f,l]=i.useState([]),[j,t]=i.useState({type_id:"",name:"",description:""});i.useEffect(()=>{n?(t({type_id:n.id||"",name:n.name||"",description:n.description||""}),l(n.levels||[])):(t({type_id:(n==null?void 0:n.id)||"",name:"",description:""}),l([]))},[n]);const r=p=>{const{name:b,value:_}=p.target;t(S=>({...S,[b]:_}))},d=p=>{p.preventDefault();const b={...j,levels:f};a(b),c()};return e.jsxs(e.Fragment,{children:[e.jsx(G,{anchor:"right",open:g,onClose:c,sx:{zIndex:p=>p.zIndex.drawer+10},children:e.jsxs(h,{sx:{width:400,p:3},role:"presentation",children:[e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(T,{variant:"h6",children:n?"Editar tipo de cuestionario":"Nuevo tipo de cuestionario"}),e.jsx(k,{onClick:c,children:e.jsx(V,{})})]}),e.jsxs(h,{component:"form",onSubmit:d,mt:2,children:[e.jsx(C,{label:"Nombre",name:"name",fullWidth:!0,value:j.name,onChange:r,required:!0}),e.jsx(C,{label:"Descripción",name:"description",fullWidth:!0,value:j.description,onChange:r,margin:"normal",required:!0}),e.jsx(w,{type:"button",variant:"text",color:"secondary",fullWidth:!0,sx:{mt:2},onClick:()=>s(!0),children:"Editar niveles"}),e.jsx(w,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},children:n?"Actualizar":"Crear"})]})]})}),e.jsx($e,{open:m,onClose:()=>s(!1),levels:f,onChange:l})]})}function Dn(){var ee,ne;const{errors:g,flash:c}=U().props,{subjects:n,types:a}=U().props,[m,s]=i.useState(!1),[f,l]=i.useState(!1),[j,t]=i.useState(!1),[r,d]=i.useState(!1),[p,b]=i.useState(null),[_,S]=i.useState(null),[I,u]=i.useState(null),D=((ne=(ee=U().props)==null?void 0:ee.flash)==null?void 0:ne.success)??null,[$,E]=i.useState(!!D),[q,o]=i.useState(!1),[O,F]=i.useState([]),[ae,J]=i.useState(!1),[ie,X]=i.useState(!1),[le,Y]=i.useState(null),[oe,B]=i.useState(!1);i.useEffect(()=>{D&&E(!0)},[D]),i.useEffect(()=>{Object.keys(g).length>0&&o(!0)},[g]);const ce=x=>{u(x),t(!0)},de=(x,A)=>{b(x),s(!0),A=="MULTITASKING"?Y("MULTITASKING"):Y("SINGLE")},ue=x=>{u(x),l(!0)},Z=()=>{s(!1),b(null),S(null)},he=()=>{t(!1),b(null),S(null)},me=()=>{l(!1),b(null),S(null)},xe=()=>{d(!0)},pe=x=>{L.Inertia.get(route("question.export",x))},je=x=>{u(x),X(!0)},fe=[{field:"name",headerName:"Tipo de cuestionario",flex:.5},{field:"description",headerName:"Descripción",flex:.5},{field:"actions",headerName:"Acciones",flex:.5,sortable:!0,renderCell:x=>e.jsxs(K,{direction:"row",spacing:1,children:[e.jsx(y,{title:"Niveles",arrow:!0,children:e.jsx(k,{onClick:()=>ue(x.row),color:"primary",children:e.jsx(re,{})})}),e.jsx(y,{title:"Asignar a Materias",arrow:!0,children:e.jsx(k,{onClick:()=>ce(x.row),color:"primary",children:e.jsx(_e,{})})}),e.jsx(y,{title:"Asignar a Materias",arrow:!0,children:e.jsx(k,{onClick:()=>je(x.row),color:"primary",children:e.jsx(se,{})})})]})}],ge=x=>{B(!0),L.Inertia.post(route("question.test"),x,{forceFormData:!0,onFinish:()=>{console.log("termino de guardar"),B(!1)}})},be=async x=>{try{const A=await te.get(route("question.show",{typeId:I==null?void 0:I.id,levelId:x==null?void 0:x.id}));A.data.questions&&(F(A.data.questions),J(!0))}catch(A){console.error("Error al obtener preguntas:",A)}},Ce=x=>{L.Inertia.put(route("type.update",x.type_id),x)};return e.jsxs(Se,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Cuestionarios"}),children:[e.jsx(we,{title:"Cuestionarios"}),e.jsx(Le,{open:$,onClose:()=>E(!1),message:D}),e.jsx(ye,{open:q,onClose:()=>o(!1),errors:g}),e.jsxs(h,{p:4,children:[e.jsx(h,{display:"flex",justifyContent:"flex-end",mb:2,children:e.jsx(w,{variant:"contained",color:"primary",onClick:xe,children:"Importar Cuestionario"})}),e.jsx(h,{sx:{height:500,width:"100%"},children:e.jsx(H,{rows:a,columns:fe,pageSize:10,rowsPerPageOptions:[5,10,20],disableSelectionOnClick:!0,autoHeight:!0})})]}),e.jsx(ke,{open:oe,sx:{color:"#fff",zIndex:x=>x.zIndex.modal+1},children:e.jsx(De,{color:"inherit"})}),le=="MULTITASKING"?e.jsx(Oe,{open:m,onClose:Z,question:p}):e.jsx(Re,{open:m,onClose:Z,question:p}),e.jsx(ze,{open:j,onClose:he,subjects:n,type:I,onSave:ge}),e.jsx(Me,{open:f,onClose:me,type:I,handleSowQuestions:be}),e.jsx(Ve,{open:ae,close:()=>J(!1),questions:O,type:I,handleEditQuestion:de}),e.jsx(Qe,{open:r,onClose:()=>d(!1),types:a,onImport:x=>{B(!0),L.Inertia.post(route("question.import"),x,{forceFormData:!0,onFinish:()=>{console.log("termino de guardar"),B(!1)}})},handleExport:pe}),e.jsx(qe,{open:ie,onClose:()=>X(!1),type:I,onSubmit:Ce})]})}export{Dn as default};
