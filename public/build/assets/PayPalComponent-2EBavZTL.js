import{r as p,R as j,a as Q,j as m}from"./app-uPHnM-9B.js";import{A as Y}from"./Alert-BvGJ135m.js";import{C as H}from"./Modal-DCnd3rmx.js";/*!
 * react-paypal-js v8.9.2 (2025-10-02T20:17:55.069Z)
 * Copyright 2020-present, PayPal, Inc. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var f;(function(e){e.INITIAL="initial",e.PENDING="pending",e.REJECTED="rejected",e.RESOLVED="resolved"})(f||(f={}));var S;(function(e){e.LOADING_STATUS="setLoadingStatus",e.RESET_OPTIONS="resetOptions",e.SET_BRAINTREE_INSTANCE="braintreeInstance"})(S||(S={}));var U;(function(e){e.NUMBER="number",e.CVV="cvv",e.EXPIRATION_DATE="expirationDate",e.EXPIRATION_MONTH="expirationMonth",e.EXPIRATION_YEAR="expirationYear",e.POSTAL_CODE="postalCode"})(U||(U={}));var c=function(){return c=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},c.apply(this,arguments)};function q(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function L(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,o;n<a;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}var I="data-react-paypal-script-id",b={DATA_JS_SDK_LIBRARY:"dataJsSdkLibrary",DATA_LIBRARY_VALUE:"react-paypal-js",DATA_NAMESPACE:"dataNamespace",DATA_SDK_INTEGRATION_SOURCE:"dataSdkIntegrationSource"},ee="Failed to load the PayPal JS SDK script.",G="paypal",te="usePayPalScriptReducer must be used within a PayPalScriptProvider";function re(e){return e===void 0&&(e=G),window[e]}function ne(e){for(var t="",r=0;r<e.length;r++){var n=e[r].charCodeAt(0)*r;e[r+1]&&(n+=e[r+1].charCodeAt(0)*(r-1)),t+=String.fromCharCode(97+Math.abs(n)%26)}return t}function ae(e){var t=e.reactComponentName,r=e.sdkComponentKey,n=e.sdkRequestedComponents,a=n===void 0?"":n,o=e.sdkDataNamespace,s=o===void 0?G:o,u=r.charAt(0).toUpperCase().concat(r.substring(1)),d="Unable to render <".concat(t," /> because window.").concat(s,".").concat(u," is undefined."),i=typeof a=="string"?a:a.join(",");if(!i.includes(r)){var l=[i,r].filter(Boolean).join();d+=`
To fix the issue, add '`.concat(r,"' to the list of components passed to the parent PayPalScriptProvider:")+"\n`<PayPalScriptProvider options={{ components: '".concat(l,"'}}>`.")}return d}function K(e){var t=e,r=I;t[r];var n=q(t,[r+""]);return"react-paypal-js-".concat(ne(JSON.stringify(n)))}function oe(e){var t=self.document.querySelector("script[".concat(I,'="').concat(e,'"]'));t!=null&&t.parentNode&&t.parentNode.removeChild(t)}function se(e,t){var r,n;switch(t.type){case S.LOADING_STATUS:return typeof t.value=="object"?c(c({},e),{loadingStatus:t.value.state,loadingStatusErrorMessage:t.value.message}):c(c({},e),{loadingStatus:t.value});case S.RESET_OPTIONS:return oe(e.options[I]),c(c({},e),{loadingStatus:f.PENDING,options:c(c((r={},r[b.DATA_SDK_INTEGRATION_SOURCE]=b.DATA_LIBRARY_VALUE,r),t.value),(n={},n[I]="".concat(K(t.value)),n))});case S.SET_BRAINTREE_INSTANCE:return c(c({},e),{braintreePayPalCheckoutInstance:t.value});default:return e}}var V=p.createContext(null);function ie(e){if(typeof(e==null?void 0:e.dispatch)=="function"&&e.dispatch.length!==0)return e;throw new Error(te)}function J(){var e=ie(p.useContext(V)),t=c(c({},e),{isInitial:e.loadingStatus===f.INITIAL,isPending:e.loadingStatus===f.PENDING,isResolved:e.loadingStatus===f.RESOLVED,isRejected:e.loadingStatus===f.REJECTED});return[t,e.dispatch]}p.createContext({});function ce(e){var t=p.useRef(new Proxy({},{get:function(r,n,a){return typeof r[n]=="function"?function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return r[n].apply(r,o)}:Reflect.get(r,n,a)}}));return t.current=Object.assign(t.current,e),t.current}var D=function(e){var t,r=e.className,n=r===void 0?"":r,a=e.disabled,o=a===void 0?!1:a,s=e.children,u=e.forceReRender,d=u===void 0?[]:u,i=q(e,["className","disabled","children","forceReRender"]),l=o?{opacity:.38}:{},y="".concat(n," ").concat(o?"paypal-buttons-disabled":"").trim(),E=p.useRef(null),v=p.useRef(null),P=ce(i),O=J()[0],R=O.isResolved,h=O.options,T=p.useState(null),A=T[0],_=T[1],g=p.useState(!0),X=g[0],z=g[1],Z=p.useState(null),C=Z[1];function N(){v.current!==null&&v.current.close().catch(function(){})}return!((t=v.current)===null||t===void 0)&&t.updateProps&&v.current.updateProps({message:i.message}),p.useEffect(function(){if(R===!1)return N;var x=re(h.dataNamespace);if(x===void 0||x.Buttons===void 0)return C(function(){throw new Error(ae({reactComponentName:D.displayName,sdkComponentKey:"buttons",sdkRequestedComponents:h.components,sdkDataNamespace:h[b.DATA_NAMESPACE]}))}),N;var $=function(w,B){_(B),typeof i.onInit=="function"&&i.onInit(w,B)};try{v.current=x.Buttons(c(c({},P),{onInit:$}))}catch(w){return C(function(){throw new Error("Failed to render <PayPalButtons /> component. Failed to initialize:  ".concat(w))})}return v.current.isEligible()===!1?(z(!1),N):(E.current&&v.current.render(E.current).catch(function(w){E.current===null||E.current.children.length===0||C(function(){throw new Error("Failed to render <PayPalButtons /> component. ".concat(w))})}),N)},L(L([R],d,!0),[i.fundingSource],!1)),p.useEffect(function(){A!==null&&(o===!0?A.disable().catch(function(){}):A.enable().catch(function(){}))},[o,A]),j.createElement(j.Fragment,null,X?j.createElement("div",{ref:E,style:l,className:y}):s)};D.displayName="PayPalButtons";function ue(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function de(e,t){var r=document.querySelector('script[src="'.concat(e,'"]'));if(r===null)return null;var n=W(e,t),a=r.cloneNode();if(delete a.dataset.uidAuto,Object.keys(a.dataset).length!==Object.keys(n.dataset).length)return null;var o=!0;return Object.keys(a.dataset).forEach(function(s){a.dataset[s]!==n.dataset[s]&&(o=!1)}),o?r:null}function le(e){var t=e.url,r=e.attributes,n=e.onSuccess,a=e.onError,o=W(t,r);o.onerror=a,o.onload=n,document.head.insertBefore(o,document.head.firstElementChild)}function pe(e){var t=e.sdkBaseUrl,r=e.environment,n=ue(e,["sdkBaseUrl","environment"]),a=t||me(r),o=n,s=Object.keys(o).filter(function(i){return typeof o[i]<"u"&&o[i]!==null&&o[i]!==""}).reduce(function(i,l){var y=o[l].toString();return l=fe(l),l.substring(0,4)==="data"||l==="crossorigin"?i.attributes[l]=y:i.queryParams[l]=y,i},{queryParams:{},attributes:{}}),u=s.queryParams,d=s.attributes;return u["merchant-id"]&&u["merchant-id"].indexOf(",")!==-1&&(d["data-merchant-id"]=u["merchant-id"],u["merchant-id"]="*"),{url:"".concat(a,"?").concat(ve(u)),attributes:d}}function fe(e){var t=function(r,n){return(n?"-":"")+r.toLowerCase()};return e.replace(/[A-Z]+(?![a-z])|[A-Z]/g,t)}function ve(e){var t="";return Object.keys(e).forEach(function(r){t.length!==0&&(t+="&"),t+=r+"="+e[r]}),t}function me(e){return e==="sandbox"?"https://www.sandbox.paypal.com/sdk/js":"https://www.paypal.com/sdk/js"}function W(e,t){t===void 0&&(t={});var r=document.createElement("script");return r.src=e,Object.keys(t).forEach(function(n){r.setAttribute(n,t[n]),n==="data-csp-nonce"&&r.setAttribute("nonce",t["data-csp-nonce"])}),r}function he(e,t){if(t===void 0&&(t=Promise),F(e,t),typeof document>"u")return t.resolve(null);var r=pe(e),n=r.url,a=r.attributes,o=a["data-namespace"]||"paypal",s=k(o);return a["data-js-sdk-library"]||(a["data-js-sdk-library"]="paypal-js"),de(n,a)&&s?t.resolve(s):ge({url:n,attributes:a},t).then(function(){var u=k(o);if(u)return u;throw new Error("The window.".concat(o," global variable is not available."))})}function ge(e,t){t===void 0&&(t=Promise),F(e,t);var r=e.url,n=e.attributes;if(typeof r!="string"||r.length===0)throw new Error("Invalid url.");if(typeof n<"u"&&typeof n!="object")throw new Error("Expected attributes to be an object.");return new t(function(a,o){if(typeof document>"u")return a();le({url:r,attributes:n,onSuccess:function(){return a()},onError:function(){var s=new Error('The script "'.concat(r,'" failed to load. Check the HTTP status code and response body in DevTools to learn more.'));return o(s)}})})}function k(e){return window[e]}function F(e,t){if(typeof e!="object"||e===null)throw new Error("Expected an options object.");var r=e.environment;if(r&&r!=="production"&&r!=="sandbox")throw new Error('The `environment` option must be either "production" or "sandbox".');if(typeof t<"u"&&typeof t!="function")throw new Error("Expected PromisePonyfill to be a function.")}var ye=function(e){var t,r=e.options,n=r===void 0?{clientId:"test"}:r,a=e.children,o=e.deferLoading,s=o===void 0?!1:o,u=p.useReducer(se,{options:c(c({},n),(t={},t[b.DATA_JS_SDK_LIBRARY]=b.DATA_LIBRARY_VALUE,t[b.DATA_SDK_INTEGRATION_SOURCE]=b.DATA_LIBRARY_VALUE,t[I]="".concat(K(n)),t)),loadingStatus:s?f.INITIAL:f.PENDING}),d=u[0],i=u[1];return p.useEffect(function(){if(s===!1&&d.loadingStatus===f.INITIAL)return i({type:S.LOADING_STATUS,value:f.PENDING});if(d.loadingStatus===f.PENDING){var l=!0;return he(d.options).then(function(){l&&i({type:S.LOADING_STATUS,value:f.RESOLVED})}).catch(function(y){console.error("".concat(ee," ").concat(y)),l&&i({type:S.LOADING_STATUS,value:{state:f.REJECTED,message:String(y)}})}),function(){l=!1}}},[d.options,s,d.loadingStatus]),j.createElement(V.Provider,{value:c(c({},d),{dispatch:i})},a)};function M(){}p.createContext({cardFieldsForm:null,fields:{},registerField:M,unregisterField:M});function Re({user:e,clientId:t,password:r="",isRenovation:n}){const[a,o]=p.useState(""),[s,u]=p.useState(!1),[d,i]=p.useState(null),l={layout:"vertical"};let y=(d==null?void 0:d.subscription_price)??500;p.useEffect(()=>{Q.get("/landing-content").then(v=>i(v.data)).catch(v=>console.error("Error al obtener contenido:",v))},[]);const E=({showSpinner:v})=>{const[{isPending:P}]=J();return m.jsxs(m.Fragment,{children:[v&&P&&m.jsx("div",{className:"spinner"}),m.jsx(D,{style:l,disabled:!1,forceReRender:[l],fundingSource:void 0,createOrder:(O,R)=>R.order.create({purchase_units:[{amount:{currency_code:"MXN",value:y},reference_id:e.id}]}),onApprove:(O,R)=>R.order.capture().then(h=>{var _;const T={order:{reference_id:h.purchase_units[0].reference_id,amount:h.purchase_units[0].amount,shipping:{address:((_=h.purchase_units[0].shipping)==null?void 0:_.address)||{}},payments:{captures:[{id:h.id,status:h.status,create_time:h.create_time}]}},password:r},A=document.querySelector('meta[name="csrf-token"]').getAttribute("content");fetch(n?"/paypal/paypal-payment-renovation":"/paypal/paypal-payment",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":A},body:JSON.stringify(T),credentials:"same-origin"}).then(g=>g.json()).then(g=>{g.success?(console.log("Pago procesado exitosamente"),o(g.message),u(!0),setTimeout(()=>{window.location.href="/student-dashboard"},5e3)):console.error("Error en la respuesta del backend:",g)}).catch(g=>{console.error("Error en el procesamiento del pago:",g)})})})]})};return m.jsxs("div",{style:{width:"100%",padding:"2rem 0.5rem",maxWidth:"750px",minHeight:"200px",position:"relative"},children:[m.jsx(ye,{options:{"client-id":t,components:"buttons",currency:"MXN",locale:"es_MX"},children:m.jsx(E,{showSpinner:!1})}),a&&m.jsxs("div",{style:{marginTop:"1rem",color:"#166534",fontWeight:"bold",textAlign:"center"},children:[m.jsx(Y,{variant:"filled",color:"green",children:a}),m.jsx("p",{style:{marginTop:"0.5rem"},children:"Ser√°s redirigido ..."}),s&&m.jsx("div",{style:{marginTop:"1rem",display:"flex",justifyContent:"center"},children:m.jsx(H,{color:"success"})})]})]})}export{Re as P};
