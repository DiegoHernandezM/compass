import{r as i,j as e,q as w,$ as A}from"./app-BvioZF8O.js";import{D as B,M as S,A as M}from"./AuthenticatedLayout-E3UBRmTd.js";import{S as G,V as R,D as V,T as v,E as $,a as W}from"./ValidationErrorAlert-BmSoism1.js";import{d as b}from"./index-L7eV0z_h.js";import{C as q,T as o,I as H,a as U}from"./Close-Dc21t6Uw.js";import{u as J}from"./ButtonBase-wecvMaha.js";import{B as p}from"./Logout-pGeDttDu.js";import{T as K}from"./Typography-QI3aQ4H6.js";import{I as C}from"./IconButton-CfOetlK4.js";import{B as N}from"./Button-Te3lklNG.js";import{S as Q}from"./Stack-ITk6zMv5.js";import"./isMuiElement-CZu2d8pn.js";import"./getThemeProps-DGe96xVY.js";import"./index-BZd934AE.js";import"./Modal-TVW6gwfh.js";import"./Slide-CCEYf0br.js";import"./useThemeProps-zsyYkAH1.js";import"./FormControlLabel-Ebh7BGzM.js";import"./useFormControl-DAU01lwA.js";import"./Alert-cMddPiOy.js";function X({open:x,onClose:g,student:a=null}){const j=new Date().toISOString().split("T")[0],f=J(),[s,h]=i.useState({name:"",email:"",password:"",birthdate:"",gender:"",phone:"",address:"",zip_code:"",city:"",country:"",school:"",expires_at:""});i.useEffect(()=>{var l,n,m,c;h(a?{name:((l=a.user)==null?void 0:l.name)||"",email:((n=a.user)==null?void 0:n.email)||"",password:"",birthdate:a.birthdate||"",gender:(a==null?void 0:a.gender)||"",phone:a.phone||"",address:a.address||"",zip_code:a.zip_code||"",city:a.city||"",country:a.country||"",school:a.school||"",expires_at:((c=(m=a.user)==null?void 0:m.paypal_user)==null?void 0:c.expires_at.substring(0,10))||""}:{name:"",email:"",password:"",birthdate:"",phone:"",address:"",zip_code:"",city:"",country:"",school:"",expires_at:""})},[a]);const t=l=>{const{name:n,value:m}=l.target;h(c=>({...c,[n]:m}))},y=l=>{l.preventDefault();const n={...s,role:"student"};a?b.Inertia.post(route("students.update",a.id),{...n,_method:"PUT"}):(console.log(n),b.Inertia.post(route("students.store"),n)),g()};return e.jsx(B,{anchor:"right",open:x,onClose:g,sx:{zIndex:f.zIndex.drawer+1},children:e.jsxs(p,{sx:{width:400,p:3},role:"presentation",children:[e.jsxs(p,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(K,{variant:"h6",children:a?"Editar Estudiante":"Nuevo Estudiante"}),e.jsx(C,{onClick:g,children:e.jsx(q,{})})]}),e.jsxs(p,{component:"form",onSubmit:y,mt:2,children:[e.jsx(o,{fullWidth:!0,label:"Nombre",name:"name",value:s.name,onChange:t,margin:"normal"}),e.jsx(o,{fullWidth:!0,label:"Correo electrónico",name:"email",type:"email",value:s.email,onChange:t,margin:"normal"}),e.jsx(o,{fullWidth:!0,label:"Contraseña",name:"password",type:"password",value:s.password,onChange:t,margin:"normal",helperText:a?"Deja en blanco si no deseas cambiar la contraseña":""}),e.jsx(o,{fullWidth:!0,label:"Fecha de nacimiento",name:"birthdate",type:"date",value:s.birthdate,onChange:t,margin:"normal",InputLabelProps:{shrink:!0},inputProps:{max:j}}),e.jsx(H,{id:"gender-label",children:"Género"}),e.jsxs(U,{fullWidth:!0,name:"gender",value:s.gender||"",label:"Género",onChange:t,children:[e.jsx(S,{value:"Masculino",children:"Masculino"}),e.jsx(S,{value:"Femenino",children:"Femenino"}),e.jsx(S,{value:"Otro",children:"Otro"})]}),e.jsx(o,{fullWidth:!0,label:"Teléfono",name:"phone",value:s.phone,onChange:t,margin:"normal"}),e.jsx(o,{fullWidth:!0,label:"Dirección",name:"address",value:s.address,onChange:t,margin:"normal"}),e.jsx(o,{fullWidth:!0,label:"CP",name:"zip_code",value:s.zip_code,onChange:t,margin:"normal"}),e.jsx(o,{fullWidth:!0,label:"Ciudad",name:"city",value:s.city,onChange:t,margin:"normal"}),e.jsx(o,{fullWidth:!0,label:"Pais",name:"country",value:s.country,onChange:t,margin:"normal"}),e.jsx(o,{fullWidth:!0,label:"Escuela",name:"school",value:s.school,onChange:t,margin:"normal"}),e.jsx(o,{fullWidth:!0,label:"Fecha de expiración",name:"expires_at",type:"date",value:s.expires_at,onChange:t,margin:"normal",InputLabelProps:{shrink:!0},inputProps:{min:j}}),e.jsx(N,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},children:a?"Actualizar":"Crear"})]})]})})}function je(){var E,_;const{errors:x,flash:g}=w().props,{students:a}=w().props,[j,f]=i.useState(!1),[s,h]=i.useState(null),t=((_=(E=w().props)==null?void 0:E.flash)==null?void 0:_.success)??null,[y,l]=i.useState(!!t),[n,m]=i.useState(!1),[c,z]=i.useState("");i.useEffect(()=>{t&&l(!0)},[t]),i.useEffect(()=>{Object.keys(x).length>0&&m(!0)},[x]);const D=r=>{h(r),f(!0)},k=()=>{h(null),f(!0)},O=r=>{confirm("¿Estás seguro de eliminar este estudiante?")&&b.Inertia.delete(route("students.destroy",r))},P=r=>{confirm("¿Estás seguro de recuperar este estudiante?")&&b.Inertia.put(route("students.restore",r))},F=a.filter(r=>{var d,u;return r.name.toLowerCase().includes(c.toLowerCase())||((u=(d=r.user)==null?void 0:d.email)==null?void 0:u.toLowerCase().includes(c.toLowerCase()))}),L=[{field:"name",headerName:"Nombre",flex:1},{field:"user_email",headerName:"Correo",flex:1.5,renderCell:r=>{var d,u;return((u=(d=r==null?void 0:r.row)==null?void 0:d.user)==null?void 0:u.email)||""}},{field:"gender",headerName:"Género",flex:1},{field:"phone",headerName:"Teléfono",flex:1},{field:"city",headerName:"Ciudad",flex:1},{field:"school",headerName:"Escuela",flex:1},{field:"user_expires_at",headerName:"Fecha Expiración",flex:1,renderCell:r=>{var u,I,T;const d=(T=(I=(u=r==null?void 0:r.row)==null?void 0:u.user)==null?void 0:I.paypal_user)==null?void 0:T.expires_at;return d?d.substring(0,10):""}},{field:"actions",headerName:"Acciones",width:120,sortable:!1,renderCell:r=>e.jsxs(Q,{direction:"row",spacing:1,children:[e.jsx(v,{title:"Editar",children:e.jsx(C,{onClick:()=>D(r.row),color:"primary",children:e.jsx($,{})})}),r.row.deleted_at?e.jsx(v,{title:"Recuperar",children:e.jsx(C,{onClick:()=>P(r.row.id),color:"success",children:e.jsx(W,{})})}):e.jsx(v,{title:"Eliminar",children:e.jsx(C,{onClick:()=>O(r.row.id),color:"error",children:e.jsx(W,{})})})]})}];return e.jsxs(M,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Estudiantes"}),children:[e.jsx(A,{title:"Estudiantes"}),e.jsx(G,{open:y,onClose:()=>l(!1),message:t}),e.jsx(R,{open:n,onClose:()=>m(!1),errors:x}),e.jsx(p,{p:4,children:e.jsxs(p,{sx:{height:600,width:"100%"},children:[e.jsxs(p,{display:"flex",justifyContent:"space-between",mb:2,children:[e.jsx(o,{label:"Buscar por nombre o correo",variant:"outlined",size:"small",value:c,onChange:r=>z(r.target.value),sx:{width:300}}),e.jsx(N,{variant:"contained",color:"primary",onClick:k,children:"Crear nuevo estudiante"})]}),e.jsx(V,{rows:F,columns:L,pageSize:10,rowsPerPageOptions:[5,10,20],disableSelectionOnClick:!0,getRowId:r=>r.id,autoHeight:!0})]})}),e.jsx(X,{open:j,onClose:()=>f(!1),student:s})]})}export{je as default};
