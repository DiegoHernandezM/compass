import{r as n,j as e}from"./app-DU9iJ9lJ.js";import{D as $}from"./Dialog-DW9ADeO5.js";import{D as N,a as O,b as G}from"./DialogTitle-ClHqApii.js";import{g as W,c as z,h as H,s as J,i as Q,f as K,T as m,r as V,u as X}from"./Typography-BtCANJAc.js";import{B as b}from"./Button-C1dAGLTF.js";import{S as Y,u as _}from"./index-C0d5k8nT.js";import{C as Z}from"./Card-_07aRrUe.js";import{C as ee}from"./CardContent-dRiIAJ1Z.js";import{L as P,F as te,S as se}from"./Stack-5xg6UJK9.js";import{B as f}from"./Box-DBi_kvVn.js";import{a as oe,i as re}from"./Modal-BrTFE178.js";import{R as ne,a as ie}from"./RadioGroup-CRrQD_Bt.js";import"./debounce-Be36O1Ab.js";import"./getThemeProps-BK4ydgtj.js";import"./useFormControl-CWQn12GJ.js";import"./index-CSQFHPNi.js";import"./useThemeProps-CgRAnLKM.js";import"./FormGroup-CEM1MaMp.js";function ae(o){return W("MuiDialogContentText",o)}z("MuiDialogContentText",["root"]);const le=o=>{const{classes:a}=o,l=K({root:["root"]},ae,a);return{...a,...l}},ce=J(m,{shouldForwardProp:o=>V(o)||o==="classes",name:"MuiDialogContentText",slot:"Root"})({}),de=n.forwardRef(function(a,d){const l=H({props:a,name:"MuiDialogContentText"}),{children:k,className:r,...u}=l,c=le(u);return e.jsx(ce,{component:"p",variant:"body1",color:"textSecondary",ref:d,ownerState:u,className:Q(c.root,r),...l,classes:c})}),ue=n.forwardRef(function(a,d){return e.jsx(Y,{direction:"up",ref:d,...a})});function me({open:o,close:a}){return e.jsx(n.Fragment,{children:e.jsxs($,{open:o,slots:{transition:ue},keepMounted:!0,onClose:a,"aria-describedby":"alert-dialog-slide-description",PaperProps:{sx:{borderRadius:4}},children:[e.jsx(N,{children:"Explicación"}),e.jsx(O,{children:e.jsx(de,{id:"alert-dialog-slide-description",children:"Let Google help apps determine location. This means sending anonymous location data to Google, even when no apps are running."})}),e.jsx(G,{children:e.jsx(b,{onClick:a,children:"Cerrar"})})]})})}function Pe({test:o,subject:a}){const d=X(),l=_(d.breakpoints.up("md")),k=_(d.breakpoints.down("sm")),[r,u]=n.useState(0),[c,v]=n.useState({}),s=o.test_questions[r],[p,x]=n.useState(null),[q,g]=n.useState(null),[C,j]=n.useState(!1),[T,D]=n.useState(!1),[h,w]=n.useState(null),[y,F]=n.useState(null);n.useEffect(()=>{if(C&&!T){const t=setTimeout(()=>{R()},2500);return()=>clearTimeout(t)}},[C,T]),n.useEffect(()=>{s!=null&&s.limit_time?(w(s.limit_time),F(s.limit_time)):(w(null),F(null))},[s]),n.useEffect(()=>{if(h===null)return;if(h<=0){S("");return}const t=setInterval(()=>{w(i=>i-1)},1e3);return()=>clearInterval(t)},[h]);const L=t=>{v({...c,[s.id]:t.target.value})},S=(t="")=>{const i=t.toUpperCase()===s.correct_answer;v(U=>({...U,[s.id]:t})),x(i?"correct":"incorrect"),i||g(s.correct_answer),!i&&(s.feedback_text||s.feedback_image)&&D(!0),j(!0),setTimeout(()=>{j(!1)},2500)},E=()=>{const t=c[s.id];t&&(S(t),setTimeout(()=>{r<o.test_questions.length-1&&(u(r),x(null),g(null))},3e3))},M=()=>{r>0&&u(r-1)},A=()=>{const t=c[s.id];t&&S(t),console.log("Enviar respuestas:",c)},B=(r+1)/o.test_questions.length*100,R=()=>{r<o.test_questions.length-1&&(u(r),x(null),g(null)),j(!1)},I=()=>{D(!1),R()};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{sx:{mb:l?2:1,mt:l?2:1,mx:l?"auto":1,width:l?"60%":"100%",borderRadius:3,boxShadow:3,backgroundColor:"rgba(255,255,255,0.95)",border:"1px solid #e0e0e0"},children:e.jsxs(ee,{sx:{backgroundColor:`${a.color}80`,borderTopLeftRadius:"12px",borderTopRightRadius:"12px"},children:[e.jsx(m,{variant:"h6",gutterBottom:!0,children:a.name}),e.jsx(P,{variant:"determinate",value:B})]})}),e.jsx(f,{sx:{mt:4,mb:2,px:1,display:"flex",alignItems:"flex-start",justifyContent:"center",minHeight:"calc(100vh - 220px)"},children:e.jsxs(oe,{elevation:3,sx:{width:"100%",maxWidth:l?600:"95%",p:3,borderRadius:3,boxShadow:3,backgroundColor:"rgba(255,255,255,0.95)",border:"1px solid #e0e0e0"},children:[y&&e.jsx(P,{variant:"determinate",value:h/y*100,sx:{mt:2,height:10,borderRadius:5}}),e.jsxs(m,{variant:"subtitle1",gutterBottom:!0,children:["Pregunta ",r+1," de ",o.test_questions.length]}),s.type==="image"?e.jsx(f,{component:"img",src:`${s.question_text}`,alt:"Pregunta",sx:{width:"100%",maxWidth:600,height:"auto",display:"block",mx:"auto",mb:4}}):e.jsx(m,{variant:"h6",gutterBottom:!0,children:s.question_text}),e.jsx(ne,{value:c[s.id]||"",onChange:L,children:Object.entries(JSON.parse(s.options)).filter(([t,i])=>i).map(([t,i])=>e.jsx(te,{value:t,control:e.jsx(ie,{}),sx:{mb:2},label:typeof i=="string"&&(i.includes("/")||i.match(/\.(png|jpg|jpeg|svg)$/i))?e.jsx(f,{component:"img",src:i,alt:`Opción ${t.toUpperCase()}`,sx:{width:70,height:70,objectFit:"contain",border:"1px solid #ccc",p:1}}):`${t.toUpperCase()}: ${i}`},t))}),e.jsxs(se,{direction:"row",justifyContent:"space-between",mt:3,children:[e.jsx(b,{variant:"outlined",onClick:M,disabled:r===0,children:"Anterior"}),r<o.test_questions.length-1?e.jsx(b,{variant:"contained",onClick:E,children:"Siguiente"}):e.jsx(b,{variant:"contained",color:"success",onClick:A,children:"Finalizar"})]}),e.jsx(re,{in:C,timeout:{enter:300,exit:500},onExited:()=>{x(null),g(null),r<o.test_questions.length-1&&u(r+1)},children:e.jsxs(f,{sx:{mt:2,p:2,borderRadius:2,backgroundColor:p==="correct"?"#dcfce7":"#fee2e2",color:p==="correct"?"#15803d":"#b91c1c",display:"flex",alignItems:"center",gap:2},children:[e.jsx("img",{src:p==="correct"?"/assets/correct.gif":"/assets/incorrect.gif",alt:"feedback gif",style:{height:70}}),e.jsx(m,{variant:"h6",children:p==="correct"?"¡Muy bien! Respuesta correcta.":`Incorrecto. La respuesta correcta era: ${q}`})]})})]})}),e.jsx(me,{open:T,close:I})]})}export{Pe as default};
