import{r as p,R as _,j as m}from"./app-CBucPHzG.js";import{A as Q}from"./Alert-COo2tptv.js";import{C as Y}from"./Typography-DJb3NVXn.js";/*!
 * react-paypal-js v8.8.3 (2025-04-11T19:50:46.506Z)
 * Copyright 2020-present, PayPal, Inc. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var f;(function(e){e.INITIAL="initial",e.PENDING="pending",e.REJECTED="rejected",e.RESOLVED="resolved"})(f||(f={}));var S;(function(e){e.LOADING_STATUS="setLoadingStatus",e.RESET_OPTIONS="resetOptions",e.SET_BRAINTREE_INSTANCE="braintreeInstance"})(S||(S={}));var B;(function(e){e.NUMBER="number",e.CVV="cvv",e.EXPIRATION_DATE="expirationDate",e.EXPIRATION_MONTH="expirationMonth",e.EXPIRATION_YEAR="expirationYear",e.POSTAL_CODE="postalCode"})(B||(B={}));var c=function(){return c=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},c.apply(this,arguments)};function M(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function U(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,o;n<a;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}var O="data-react-paypal-script-id",b={DATA_JS_SDK_LIBRARY:"dataJsSdkLibrary",DATA_LIBRARY_VALUE:"react-paypal-js",DATA_NAMESPACE:"dataNamespace",DATA_SDK_INTEGRATION_SOURCE:"dataSdkIntegrationSource"},H="Failed to load the PayPal JS SDK script.",q="paypal",ee="usePayPalScriptReducer must be used within a PayPalScriptProvider";function te(e){return e===void 0&&(e=q),window[e]}function re(e){for(var t="",r=0;r<e.length;r++){var n=e[r].charCodeAt(0)*r;e[r+1]&&(n+=e[r+1].charCodeAt(0)*(r-1)),t+=String.fromCharCode(97+Math.abs(n)%26)}return t}function ne(e){var t=e.reactComponentName,r=e.sdkComponentKey,n=e.sdkRequestedComponents,a=n===void 0?"":n,o=e.sdkDataNamespace,i=o===void 0?q:o,u=r.charAt(0).toUpperCase().concat(r.substring(1)),d="Unable to render <".concat(t," /> because window.").concat(i,".").concat(u," is undefined."),s=typeof a=="string"?a:a.join(",");if(!s.includes(r)){var l=[s,r].filter(Boolean).join();d+=`
To fix the issue, add '`.concat(r,"' to the list of components passed to the parent PayPalScriptProvider:")+"\n`<PayPalScriptProvider options={{ components: '".concat(l,"'}}>`.")}return d}function G(e){var t=e,r=O;t[r];var n=M(t,[r+""]);return"react-paypal-js-".concat(re(JSON.stringify(n)))}function ae(e){var t=self.document.querySelector("script[".concat(O,'="').concat(e,'"]'));t!=null&&t.parentNode&&t.parentNode.removeChild(t)}function oe(e,t){var r,n;switch(t.type){case S.LOADING_STATUS:return typeof t.value=="object"?c(c({},e),{loadingStatus:t.value.state,loadingStatusErrorMessage:t.value.message}):c(c({},e),{loadingStatus:t.value});case S.RESET_OPTIONS:return ae(e.options[O]),c(c({},e),{loadingStatus:f.PENDING,options:c(c((r={},r[b.DATA_SDK_INTEGRATION_SOURCE]=b.DATA_LIBRARY_VALUE,r),t.value),(n={},n[O]="".concat(G(t.value)),n))});case S.SET_BRAINTREE_INSTANCE:return c(c({},e),{braintreePayPalCheckoutInstance:t.value});default:return e}}var K=p.createContext(null);function ie(e){if(typeof(e==null?void 0:e.dispatch)=="function"&&e.dispatch.length!==0)return e;throw new Error(ee)}function V(){var e=ie(p.useContext(K)),t=c(c({},e),{isInitial:e.loadingStatus===f.INITIAL,isPending:e.loadingStatus===f.PENDING,isResolved:e.loadingStatus===f.RESOLVED,isRejected:e.loadingStatus===f.REJECTED});return[t,e.dispatch]}p.createContext({});function se(e){var t=p.useRef(new Proxy({},{get:function(r,n,a){return typeof r[n]=="function"?function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return r[n].apply(r,o)}:Reflect.get(r,n,a)}}));return t.current=Object.assign(t.current,e),t.current}var C=function(e){var t,r=e.className,n=r===void 0?"":r,a=e.disabled,o=a===void 0?!1:a,i=e.children,u=e.forceReRender,d=u===void 0?[]:u,s=M(e,["className","disabled","children","forceReRender"]),l=o?{opacity:.38}:{},h="".concat(n," ").concat(o?"paypal-buttons-disabled":"").trim(),E=p.useRef(null),y=p.useRef(null),R=se(s),g=V()[0],T=g.isResolved,A=g.options,N=p.useState(null),v=N[0],F=N[1],x=p.useState(!0),X=x[0],z=x[1],Z=p.useState(null),j=Z[1];function w(){y.current!==null&&y.current.close().catch(function(){})}return!((t=y.current)===null||t===void 0)&&t.updateProps&&y.current.updateProps({message:s.message}),p.useEffect(function(){if(T===!1)return w;var P=te(A.dataNamespace);if(P===void 0||P.Buttons===void 0)return j(function(){throw new Error(ne({reactComponentName:C.displayName,sdkComponentKey:"buttons",sdkRequestedComponents:A.components,sdkDataNamespace:A[b.DATA_NAMESPACE]}))}),w;var $=function(I,D){F(D),typeof s.onInit=="function"&&s.onInit(I,D)};try{y.current=P.Buttons(c(c({},R),{onInit:$}))}catch(I){return j(function(){throw new Error("Failed to render <PayPalButtons /> component. Failed to initialize:  ".concat(I))})}return y.current.isEligible()===!1?(z(!1),w):(E.current&&y.current.render(E.current).catch(function(I){E.current===null||E.current.children.length===0||j(function(){throw new Error("Failed to render <PayPalButtons /> component. ".concat(I))})}),w)},U(U([T],d,!0),[s.fundingSource],!1)),p.useEffect(function(){v!==null&&(o===!0?v.disable().catch(function(){}):v.enable().catch(function(){}))},[o,v]),_.createElement(_.Fragment,null,X?_.createElement("div",{ref:E,style:l,className:h}):i)};C.displayName="PayPalButtons";function ce(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function ue(e,t){var r=document.querySelector('script[src="'.concat(e,'"]'));if(r===null)return null;var n=J(e,t),a=r.cloneNode();if(delete a.dataset.uidAuto,Object.keys(a.dataset).length!==Object.keys(n.dataset).length)return null;var o=!0;return Object.keys(a.dataset).forEach(function(i){a.dataset[i]!==n.dataset[i]&&(o=!1)}),o?r:null}function de(e){var t=e.url,r=e.attributes,n=e.onSuccess,a=e.onError,o=J(t,r);o.onerror=a,o.onload=n,document.head.insertBefore(o,document.head.firstElementChild)}function le(e){var t=e.sdkBaseUrl,r=e.environment,n=ce(e,["sdkBaseUrl","environment"]),a=t||ve(r),o=n,i=Object.keys(o).filter(function(s){return typeof o[s]<"u"&&o[s]!==null&&o[s]!==""}).reduce(function(s,l){var h=o[l].toString();return l=pe(l),l.substring(0,4)==="data"||l==="crossorigin"?s.attributes[l]=h:s.queryParams[l]=h,s},{queryParams:{},attributes:{}}),u=i.queryParams,d=i.attributes;return u["merchant-id"]&&u["merchant-id"].indexOf(",")!==-1&&(d["data-merchant-id"]=u["merchant-id"],u["merchant-id"]="*"),{url:"".concat(a,"?").concat(fe(u)),attributes:d}}function pe(e){var t=function(r,n){return(n?"-":"")+r.toLowerCase()};return e.replace(/[A-Z]+(?![a-z])|[A-Z]/g,t)}function fe(e){var t="";return Object.keys(e).forEach(function(r){t.length!==0&&(t+="&"),t+=r+"="+e[r]}),t}function ve(e){return e==="sandbox"?"https://www.sandbox.paypal.com/sdk/js":"https://www.paypal.com/sdk/js"}function J(e,t){t===void 0&&(t={});var r=document.createElement("script");return r.src=e,Object.keys(t).forEach(function(n){r.setAttribute(n,t[n]),n==="data-csp-nonce"&&r.setAttribute("nonce",t["data-csp-nonce"])}),r}function me(e,t){if(t===void 0&&(t=Promise),W(e,t),typeof document>"u")return t.resolve(null);var r=le(e),n=r.url,a=r.attributes,o=a["data-namespace"]||"paypal",i=L(o);return a["data-js-sdk-library"]||(a["data-js-sdk-library"]="paypal-js"),ue(n,a)&&i?t.resolve(i):he({url:n,attributes:a},t).then(function(){var u=L(o);if(u)return u;throw new Error("The window.".concat(o," global variable is not available."))})}function he(e,t){t===void 0&&(t=Promise),W(e,t);var r=e.url,n=e.attributes;if(typeof r!="string"||r.length===0)throw new Error("Invalid url.");if(typeof n<"u"&&typeof n!="object")throw new Error("Expected attributes to be an object.");return new t(function(a,o){if(typeof document>"u")return a();de({url:r,attributes:n,onSuccess:function(){return a()},onError:function(){var i=new Error('The script "'.concat(r,'" failed to load. Check the HTTP status code and response body in DevTools to learn more.'));return o(i)}})})}function L(e){return window[e]}function W(e,t){if(typeof e!="object"||e===null)throw new Error("Expected an options object.");var r=e.environment;if(r&&r!=="production"&&r!=="sandbox")throw new Error('The `environment` option must be either "production" or "sandbox".');if(typeof t<"u"&&typeof t!="function")throw new Error("Expected PromisePonyfill to be a function.")}var ye=function(e){var t,r=e.options,n=r===void 0?{clientId:"test"}:r,a=e.children,o=e.deferLoading,i=o===void 0?!1:o,u=p.useReducer(oe,{options:c(c({},n),(t={},t[b.DATA_JS_SDK_LIBRARY]=b.DATA_LIBRARY_VALUE,t[b.DATA_SDK_INTEGRATION_SOURCE]=b.DATA_LIBRARY_VALUE,t[O]="".concat(G(n)),t)),loadingStatus:i?f.INITIAL:f.PENDING}),d=u[0],s=u[1];return p.useEffect(function(){if(i===!1&&d.loadingStatus===f.INITIAL)return s({type:S.LOADING_STATUS,value:f.PENDING});if(d.loadingStatus===f.PENDING){var l=!0;return me(d.options).then(function(){l&&s({type:S.LOADING_STATUS,value:f.RESOLVED})}).catch(function(h){console.error("".concat(H," ").concat(h)),l&&s({type:S.LOADING_STATUS,value:{state:f.REJECTED,message:String(h)}})}),function(){l=!1}}},[d.options,i,d.loadingStatus]),_.createElement(K.Provider,{value:c(c({},d),{dispatch:s})},a)};function k(){}p.createContext({cardFieldsForm:null,fields:{},registerField:k,unregisterField:k});function be({user:e,clientId:t,password:r="",isRenovation:n}){const[a,o]=p.useState(""),[i,u]=p.useState(!1),d={layout:"vertical"};let s="1";const l=({showSpinner:h})=>{const[{isPending:E}]=V();return m.jsxs(m.Fragment,{children:[h&&E&&m.jsx("div",{className:"spinner"}),m.jsx(C,{style:d,disabled:!1,forceReRender:[d],fundingSource:void 0,createOrder:(y,R)=>R.order.create({purchase_units:[{amount:{currency_code:"MXN",value:s},reference_id:e.id}]}),onApprove:(y,R)=>R.order.capture().then(g=>{var N;const T={order:{reference_id:g.purchase_units[0].reference_id,amount:g.purchase_units[0].amount,shipping:{address:((N=g.purchase_units[0].shipping)==null?void 0:N.address)||{}},payments:{captures:[{id:g.id,status:g.status,create_time:g.create_time}]}},password:r},A=document.querySelector('meta[name="csrf-token"]').getAttribute("content");fetch(n?"/paypal/paypal-payment-renovation":"/paypal/paypal-payment",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":A},body:JSON.stringify(T),credentials:"same-origin"}).then(v=>v.json()).then(v=>{v.success?(console.log("Pago procesado exitosamente"),o(v.message),u(!0),setTimeout(()=>{window.location.href="/student-dashboard"},5e3)):console.error("Error en la respuesta del backend:",v)}).catch(v=>{console.error("Error en el procesamiento del pago:",v)})})})]})};return m.jsxs("div",{style:{width:"100%",padding:"2rem 0.5rem",maxWidth:"750px",minHeight:"200px",position:"relative"},children:[m.jsx(ye,{options:{"client-id":t,components:"buttons",currency:"MXN",locale:"es_MX"},children:m.jsx(l,{showSpinner:!1})}),a&&m.jsxs("div",{style:{marginTop:"1rem",color:"#166534",fontWeight:"bold",textAlign:"center"},children:[m.jsx(Q,{variant:"filled",color:"green",children:a}),m.jsx("p",{style:{marginTop:"0.5rem"},children:"Serás redirigido ..."}),i&&m.jsx("div",{style:{marginTop:"1rem",display:"flex",justifyContent:"center"},children:m.jsx(Y,{color:"success"})})]})]})}export{be as P};
