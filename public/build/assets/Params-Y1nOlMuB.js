import{r as o,j as e}from"./app-DO6qCxou.js";import{u as K,T as c}from"./Typography-hDusPIBd.js";import{u as L}from"./index-BKZ9OXpj.js";import{C as P}from"./Card-UBjRlPVS.js";import{C as _}from"./CardContent-CNNr1Dww.js";import{B as a}from"./Box-DECm0aEA.js";import{L as N}from"./LinearProgress-w_Y0VxrK.js";import{F as W}from"./Fade-4O_EcEW8.js";import{B}from"./Button-aaGi_c7-.js";import"./getThemeProps-BA-uR2tL.js";import"./index-Dw4eyy0A.js";function ne({test:l,subject:n}){const C=K(),d=L(C.breakpoints.up("md")),E=L(C.breakpoints.down("sm")),[u,M]=o.useState(0),[m,j]=o.useState(!0),[p,q]=o.useState({}),[S,F]=o.useState([]),[v,T]=o.useState({}),[i,y]=o.useState(null),[H,w]=o.useState(null),[h,R]=o.useState(0),[U,A]=o.useState(0),x=l.test_questions[u];o.useEffect(()=>{if(!x)return;j(!0),T({}),y(null),w(null);const t={};x.question_text.split(`
`).forEach(z=>{const[k,I]=z.split(":");k&&I&&(t[k.trim().toUpperCase()]=I.trim())}),q(t);const r=l.question_level_id,s=Object.keys(t),f=r===14?1:r===15?2:4,g=[...s].sort(()=>.5-Math.random());F(g.slice(0,f));const b=x.limit_time||5;R(b),A(b);const $=setTimeout(()=>{j(!1)},b*1e3);return()=>clearTimeout($)},[x]),o.useEffect(()=>{if(!m||h<=0)return;const t=setInterval(()=>{R(r=>r-1)},1e3);return()=>clearInterval(t)},[m,h]);const O=(t,r)=>{T(s=>({...s,[t]:r}))},Q=()=>{const t=S.find(s=>{const f=(p[s]||"").toLowerCase().trim(),g=(v[s]||"").toLowerCase().trim();return f!==g}),r=!t;y(r?"correct":"incorrect"),r||w(p[t])},V=()=>{u<l.test_questions.length-1?M(u+1):console.log("Test completado")};return e.jsxs(e.Fragment,{children:[e.jsx(P,{sx:{mb:d?2:1,mt:d?2:1,mx:d?"auto":1,width:d?"60%":"100%",borderRadius:3,boxShadow:3,backgroundColor:"rgba(255,255,255,0.95)",border:"1px solid #e0e0e0"},children:e.jsx(_,{sx:{backgroundColor:`${n==null?void 0:n.color}80`,borderTopLeftRadius:"12px",borderTopRightRadius:"12px"},children:e.jsx(c,{variant:"h6",gutterBottom:!0,children:n==null?void 0:n.name})})}),e.jsx(a,{sx:{mt:4,mb:2,px:1,display:"flex",alignItems:"flex-start",justifyContent:"center",minHeight:"calc(100vh - 220px)"},children:e.jsx(P,{sx:{width:"100%",maxWidth:500,borderRadius:3,boxShadow:4},children:e.jsxs(_,{children:[e.jsx(N,{variant:"determinate",value:h/U*100,sx:{mb:2,height:10,borderRadius:5}}),e.jsxs(c,{variant:"subtitle1",gutterBottom:!0,children:["Pregunta ",u+1," de ",l.test_questions.length]}),e.jsx(a,{sx:{border:"2px solid #333",borderRadius:2,p:3,backgroundColor:"#000",color:"#0f0",fontFamily:"monospace",mt:2},children:Object.entries(p).map(([t,r])=>e.jsxs(a,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(c,{children:t}),m||!S.includes(t.toUpperCase())?e.jsx(c,{children:r}):e.jsx("input",{type:"text",value:v[t]||"",onChange:s=>O(t,s.target.value),style:{width:100,padding:4,borderRadius:4,backgroundColor:"#fff",color:"#000",fontSize:"1rem"}})]},t))}),!m&&e.jsx(a,{mt:4,textAlign:"center",children:i?e.jsx(W,{in:!0,children:e.jsx(a,{sx:{p:2,borderRadius:2,backgroundColor:i==="correct"?"#dcfce7":"#fee2e2",color:i==="correct"?"#15803d":"#b91c1c",display:"inline-block"},children:e.jsx(c,{variant:"h6",children:i==="correct"?"Â¡Muy bien! Respuesta correcta.":`Incorrecto. La respuesta correcta era: ${H}`})})}):e.jsx(B,{variant:"contained",onClick:Q,children:"Enviar respuesta"})}),i&&e.jsx(a,{mt:3,textAlign:"center",children:e.jsx(B,{variant:"contained",onClick:V,children:"Siguiente"})})]})})})]})}export{ne as default};
