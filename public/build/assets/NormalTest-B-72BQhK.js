import{r as n,j as e}from"./app-CBucPHzG.js";import"./index-BGU7hHMp.js";import{D as B}from"./Dialog-sDwa-wob.js";import{D as I,a as M,b as N}from"./DialogTitle-oN21Xprn.js";import{g as U,b as O,f as $,s as G,h as z,e as J,r as W}from"./ButtonBase-DdA8Ku2c.js";import{T as u}from"./Typography-DJb3NVXn.js";import{B as g}from"./Button-CTICrhqb.js";import{S as H}from"./Slide-KN0NCWVU.js";import{C as K}from"./Card-Kf_3m0Z3.js";import{C as Q}from"./CardContent-WCKHYL--.js";import{L as D,F as V,S as X}from"./Stack-Cb4FCVXq.js";import{B as R}from"./Box-m--2wziB.js";import{P as Y}from"./useSlot-CJPmMWAX.js";import{R as Z,a as ee}from"./RadioGroup-Ds0w_6sr.js";import{d as te}from"./Modal-BEcyDk9H.js";import"./useFormControl-BsPVMvoc.js";import"./index-CQUi5ALd.js";import"./useThemeProps-BAltvEUj.js";import"./getThemeProps-CQcBN-ro.js";import"./FormGroup-5qyDL-Mc.js";function oe(s){return U("MuiDialogContentText",s)}O("MuiDialogContentText",["root"]);const se=s=>{const{classes:i}=s,a=J({root:["root"]},oe,i);return{...i,...a}},re=G(u,{shouldForwardProp:s=>W(s)||s==="classes",name:"MuiDialogContentText",slot:"Root"})({}),ne=n.forwardRef(function(i,r){const a=$({props:i,name:"MuiDialogContentText"}),{children:d,className:m,...t}=a,c=se(t);return e.jsx(re,{component:"p",variant:"body1",color:"textSecondary",ref:r,ownerState:t,className:z(c.root,m),...a,classes:c})}),ie=n.forwardRef(function(i,r){return e.jsx(H,{direction:"up",ref:r,...i})});function ae({open:s,close:i}){return e.jsx(n.Fragment,{children:e.jsxs(B,{open:s,slots:{transition:ie},keepMounted:!0,onClose:i,"aria-describedby":"alert-dialog-slide-description",PaperProps:{sx:{borderRadius:4}},children:[e.jsx(I,{children:"Explicación"}),e.jsx(M,{children:e.jsx(ne,{id:"alert-dialog-slide-description",children:"Let Google help apps determine location. This means sending anonymous location data to Google, even when no apps are running."})}),e.jsx(N,{children:e.jsx(g,{onClick:i,children:"Cerrar"})})]})})}function Fe({test:s,subject:i}){const[r,a]=n.useState(0),[d,m]=n.useState({}),t=s.test_questions[r],[c,p]=n.useState(null),[F,x]=n.useState(null),[h,b]=n.useState(!1),[C,v]=n.useState(!1),[f,j]=n.useState(null),[w,S]=n.useState(null);n.useEffect(()=>{if(h&&!C){const o=setTimeout(()=>{k()},2500);return()=>clearTimeout(o)}},[h,C]),n.useEffect(()=>{t!=null&&t.limit_time?(j(t.limit_time),S(t.limit_time)):(j(null),S(null))},[t]),n.useEffect(()=>{if(f===null)return;if(f<=0){T("");return}const o=setInterval(()=>{j(l=>l-1)},1e3);return()=>clearInterval(o)},[f]);const _=o=>{m({...d,[t.id]:o.target.value})},T=(o="")=>{const l=o.toUpperCase()===t.correct_answer;m(A=>({...A,[t.id]:o})),p(l?"correct":"incorrect"),l||x(t.correct_answer),!l&&(t.feedback_text||t.feedback_image)&&v(!0),b(!0),setTimeout(()=>{b(!1)},2500)},y=()=>{const o=d[t.id];o&&(T(o),setTimeout(()=>{r<s.test_questions.length-1&&(a(r),p(null),x(null))},3e3))},P=()=>{r>0&&a(r-1)},q=()=>{const o=d[t.id];o&&T(o),console.log("Enviar respuestas:",d)},E=(r+1)/s.test_questions.length*100,k=()=>{r<s.test_questions.length-1&&(a(r),p(null),x(null)),b(!1)},L=()=>{v(!1),k()};return e.jsxs(e.Fragment,{children:[e.jsx(K,{sx:{mb:4,borderRadius:3,boxShadow:3,backgroundColor:"rgba(255,255,255,0.95)",border:"1px solid #e0e0e0"},children:e.jsxs(Q,{sx:{backgroundColor:`${i.color}80`,borderTopLeftRadius:"12px",borderTopRightRadius:"12px"},children:[e.jsx(u,{variant:"h6",gutterBottom:!0,children:i.name}),e.jsx(D,{variant:"determinate",value:E})]})}),e.jsx(R,{sx:{height:"calc(100vh - 220px)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(Y,{elevation:3,sx:{width:"100%",maxWidth:700,p:3,borderRadius:3,boxShadow:3,backgroundColor:"rgba(255,255,255,0.95)",border:"1px solid #e0e0e0"},children:[w&&e.jsx(D,{variant:"determinate",value:f/w*100,sx:{mt:2,height:10,borderRadius:5}}),e.jsxs(u,{variant:"subtitle1",gutterBottom:!0,children:["Pregunta ",r+1," de ",s.test_questions.length]}),e.jsx(u,{variant:"h6",gutterBottom:!0,children:t.question_text}),e.jsx(Z,{value:d[t.id]||"",onChange:_,children:Object.entries(JSON.parse(t.options)).filter(([o,l])=>l).map(([o,l])=>e.jsx(V,{value:o,control:e.jsx(ee,{}),label:`${o.toUpperCase()}: ${l}`},o))}),e.jsxs(X,{direction:"row",justifyContent:"space-between",mt:3,children:[e.jsx(g,{variant:"outlined",onClick:P,disabled:r===0,children:"Anterior"}),r<s.test_questions.length-1?e.jsx(g,{variant:"contained",onClick:y,children:"Siguiente"}):e.jsx(g,{variant:"contained",color:"success",onClick:q,children:"Finalizar"})]}),e.jsx(te,{in:h,timeout:{enter:300,exit:500},onExited:()=>{p(null),x(null),r<s.test_questions.length-1&&a(r+1)},children:e.jsxs(R,{sx:{mt:2,p:2,borderRadius:2,backgroundColor:c==="correct"?"#dcfce7":"#fee2e2",color:c==="correct"?"#15803d":"#b91c1c",display:"flex",alignItems:"center",gap:2},children:[e.jsx("img",{src:c==="correct"?"/assets/correct.gif":"/assets/incorrect.gif",alt:"feedback gif",style:{height:70}}),e.jsx(u,{variant:"h6",children:c==="correct"?"¡Muy bien! Respuesta correcta.":`Incorrecto. La respuesta correcta era: ${F}`})]})})]})}),e.jsx(ae,{open:C,close:L})]})}export{Fe as default};
