import{r as i,j as e,a as re,q as K,$ as we}from"./app-B7h2jG03.js";import{d as y}from"./index-BJjjDWMy.js";import{V as se}from"./VisibilityOff-6Ow42ivF.js";import{I as ve,A as _e}from"./index-WiaFBWqs.js";import{E as ae,D as Ie}from"./Edit-5jAfhAWn.js";import{D as H,A as Se}from"./AuthenticatedLayout-BagKDu97.js";import{C as $}from"./Close-hWO7Xnjc.js";import{B as h}from"./Box-DGyrRjtI.js";import{T as A,B as ke,C as De}from"./Modal-rIM6T3Aq.js";import{I as k}from"./Alert-Brfjgq8I.js";import{T as C,F as T,I as R,S as L}from"./TextField-dA6Bynkk.js";import{M as v,A as Ee,T as Ne}from"./ErrorAlert-D1RGvLXb.js";import{B as w}from"./Button-8zqjo8_Q.js";import{D as O}from"./Dialog-ENnBY_5a.js";import{D as M,a as B,b as V}from"./DialogTitle-Cww0Iu9Q.js";import{F as Te}from"./FormGroup-B86q1HVx.js";import{F as We,S as J}from"./Stack-Ap4uvUEf.js";import{C as Fe,D as X,T as P,a as Ae}from"./DataGrid-CVzoY1Br.js";import{S as Le,V as ye}from"./ValidationErrorAlert-B15XW0Qb.js";import{S as Pe}from"./index-B435XVQQ.js";import"./createSvgIcon-B2hiN-Y6.js";import"./School-DgLf7YVQ.js";import"./Person-D1bkoAu7.js";import"./MenuBook-DOqNpYgT.js";import"./Logout-CsPcWL1h.js";import"./isMuiElement-y8-AjAI9.js";import"./index-ByWolOJP.js";import"./useFormControl-DRstkiv1.js";import"./useThemeProps-UpgmQkA3.js";import"./getThemeProps-7Rpbd0ZB.js";import"./index-S2eiiw7d.js";import"./LinearProgress-1hQ77MM0.js";import"./TableCell-DGPe-auq.js";function Re({open:g,onClose:d,question:n=null}){const[a,m]=i.useState({question:"",answer_a:"",answer_b:"",answer_c:"",answer_d:"",correct_answer:"",feedback_text:"",feedback_image:null});i.useEffect(()=>{m({question:(n==null?void 0:n.question)||"",answer_a:(n==null?void 0:n.answer_a)||"",answer_b:(n==null?void 0:n.answer_b)||"",answer_c:(n==null?void 0:n.answer_c)||"",answer_d:(n==null?void 0:n.answer_d)||"",correct_answer:(n==null?void 0:n.correct_answer)||"",feedback_text:(n==null?void 0:n.feedback_text)||"",feedback_image:null,has_dynamic:(n==null?void 0:n.has_dynamic)||!1})},[n]);const s=l=>{const{name:f,type:t,files:r,value:c,checked:p}=l.target,b=t==="file"?r[0]:t==="checkbox"?p:c;m(_=>({..._,[f]:b}))},j=l=>{l.preventDefault();const f={...a};y.Inertia.post(route("question.update",n.id),{...f,_method:"PUT"},{forceFormData:!0}),d()};return e.jsx(H,{anchor:"right",open:g,onClose:d,sx:{zIndex:l=>l.zIndex.drawer+1e3},children:e.jsxs(h,{sx:{width:400,p:3},role:"presentation",children:[e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(A,{variant:"h6",children:n?"Editar Pregunta":"Nueva Pregunta"}),e.jsx(k,{onClick:d,children:e.jsx($,{})})]}),e.jsxs(h,{component:"form",onSubmit:j,mt:2,children:[e.jsx(C,{label:"Pregunta",name:"question",fullWidth:!0,value:a.question,onChange:s,margin:"normal",required:!0}),e.jsx(C,{label:"Respuesta A",name:"answer_a",fullWidth:!0,value:a.answer_a,onChange:s,margin:"normal",required:!0}),e.jsx(C,{label:"Respuesta B",name:"answer_b",fullWidth:!0,value:a.answer_b,onChange:s,margin:"normal",required:!0}),e.jsx(C,{label:"Respuesta C",name:"answer_c",fullWidth:!0,value:a.answer_c,onChange:s,margin:"normal",required:!0}),e.jsx(C,{label:"Respuesta D",name:"answer_d",fullWidth:!0,value:a.answer_d,onChange:s,margin:"normal"}),e.jsxs(T,{fullWidth:!0,margin:"normal",required:!0,children:[e.jsx(R,{id:"correct-answer-label",children:"Respuesta Correcta"}),e.jsxs(L,{labelId:"correct-answer-label",name:"correct_answer",value:a.correct_answer,label:"Respuesta Correcta",onChange:s,MenuProps:{container:document.body,disablePortal:!0},children:[e.jsx(v,{value:"A",children:"A"}),e.jsx(v,{value:"B",children:"B"}),e.jsx(v,{value:"C",children:"C"}),e.jsx(v,{value:"D",children:"D"})]})]}),e.jsx(C,{label:"Retroalimentación",name:"feedback_text",fullWidth:!0,multiline:!0,rows:3,value:a.feedback_text,onChange:s,margin:"normal"}),e.jsx("input",{type:"file",name:"feedback_image",onChange:s,style:{marginTop:16}}),e.jsx(w,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},children:"Actualizar"})]})]})})}function Oe({open:g,onClose:d,question:n=null}){console.log(n);const[a,m]=i.useState({question:"",option_a:"",option_b:"",option_c:"",answer:""});i.useEffect(()=>{m({question:n.question||"",option_a:n.option_a||"",option_b:n.option_b||"",option_c:n.option_c||"",answer:n.answer||""})},[n]);const s=l=>{const{name:f,type:t,files:r,value:c,checked:p}=l.target,b=t==="file"?r[0]:t==="checkbox"?p:c;m(_=>({..._,[f]:b}))},j=l=>{l.preventDefault();const f={...a};y.Inertia.post(route("question-multitask.update",n.id),{...f,_method:"PUT"}),d()};return e.jsx(H,{anchor:"right",open:g,onClose:d,sx:{zIndex:l=>l.zIndex.drawer+1e3},children:e.jsxs(h,{sx:{width:400,p:3},role:"presentation",children:[e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(A,{variant:"h6",children:"Editar Pregunta"}),e.jsx(k,{onClick:d,children:e.jsx($,{})})]}),e.jsxs(h,{component:"form",onSubmit:j,mt:2,children:[e.jsx(C,{label:"Pregunta",name:"question",fullWidth:!0,value:a.question,onChange:s,margin:"normal",required:!0}),e.jsx(C,{label:"Respuesta A",name:"option_a",fullWidth:!0,value:a.option_a,onChange:s,margin:"normal",required:!0}),e.jsx(C,{label:"Respuesta B",name:"option_b",fullWidth:!0,value:a.option_b,onChange:s,margin:"normal",required:!0}),e.jsx(C,{label:"Respuesta C",name:"option_c",fullWidth:!0,value:a.option_c,onChange:s,margin:"normal"}),e.jsxs(T,{fullWidth:!0,margin:"normal",required:!0,children:[e.jsx(R,{id:"correct-answer-label",children:"Respuesta Correcta"}),(n==null?void 0:n.type)=="figure"?e.jsxs(L,{labelId:"correct-answer-label",name:"answer",value:a.answer,label:"Respuesta Correcta",onChange:s,MenuProps:{container:document.body,disablePortal:!0},children:[e.jsx(v,{value:"x1",children:"x1"}),e.jsx(v,{value:"x2",children:"x2"}),e.jsx(v,{value:"x3",children:"x3"})]}):e.jsxs(L,{labelId:"correct-answer-label",name:"answer",value:a.answer,label:"Respuesta Correcta",onChange:s,MenuProps:{container:document.body,disablePortal:!0},children:[e.jsx(v,{value:"Incorrecto",children:"Incorrecto"}),e.jsx(v,{value:"Correcto",children:"Correcto"})]})]}),e.jsx(w,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},children:"Actualizar"})]})]})})}function Qe({open:g,onClose:d,type:n,subjects:a,onSave:m}){const[s,j]=i.useState(""),[l,f]=i.useState(""),t=a.find(o=>o.id===Number(s)),r=(n==null?void 0:n.levels)||[],c=r.find(o=>o.id===Number(l)),[p,b]=i.useState(!1),[_,S]=i.useState(""),[I,u]=i.useState(""),D=(n==null?void 0:n.bypass_levels_and_questions)===1,[q,W]=i.useState(!1),[U,Q]=i.useState(!1);i.useEffect(()=>{(async()=>{var z;if(s&&l)try{const F=await re.get(`/admin/question/check-existence/${s}/${l}/${n==null?void 0:n.id}`);((z=F.data)==null?void 0:z.exists.length)>0&&(console.log(F.data.exists),W(!0))}catch(F){console.error("Error al verificar test existente:",F)}})()},[s,l]);const G=()=>{if(n!=null&&n.id&&s){const o=new FormData;o.append("subject_id",s),o.append("question_type_id",n==null?void 0:n.id),o.append("question_level_id",l),o.append("question_count",_),o.append("has_time_limit",p?"1":"0"),o.append("reset",U),p&&o.append("time_limit",I),m(o),Q(!1),j(""),f(""),S(""),u(""),d()}};return e.jsxs(e.Fragment,{children:[e.jsxs(O,{open:g,onClose:(o,z)=>{},fullWidth:!0,maxWidth:"xl",disableEscapeKeyDown:!0,children:[e.jsxs(M,{children:["Tipo de cuestionario: ",n==null?void 0:n.name]}),e.jsx(B,{children:e.jsxs(h,{sx:{mt:2},children:[e.jsxs(T,{fullWidth:!0,margin:"normal",children:[e.jsx(R,{id:"type-select-label",children:"Materias"}),e.jsx(L,{labelId:"type-select-label",value:s??"",label:"Materias",onChange:o=>{j(o.target.value),f("")},required:!0,children:a.map(o=>e.jsx(v,{value:o.id,children:o.name},o.id))})]}),e.jsxs(T,{fullWidth:!0,margin:"normal",disabled:r.length==0,children:[e.jsx(R,{id:"level-select-label",children:"Nivel de complejidad"}),e.jsx(L,{labelId:"level-select-label",value:l??"",label:"Nivel de complejidad",onChange:o=>f(o.target.value),required:r.length>0,children:r.map(o=>e.jsxs(v,{value:o.id,children:[o.name," - ",o.description]},o.id))})]}),(c||D)&&e.jsxs(T,{fullWidth:!0,margin:"normal",children:[e.jsx(A,{variant:"subtitle1",component:"p",children:D?"Número de preguntas para el examen":`Preguntas disponibles sobre examen (${c?c.questions_count||0:(t==null?void 0:t.questions_count)||0})`}),e.jsx(C,{id:"count-question-required",label:"Número de preguntas para examen",type:"number",inputProps:{min:1,...D?{}:{max:c?c.questions_count:(t==null?void 0:t.questions_count)||1}},onChange:o=>S(o.target.value),required:!0})]}),D||s&&e.jsx(Te,{children:e.jsx(We,{control:e.jsx(Fe,{checked:p,onChange:o=>b(o.target.checked)}),label:"Tiempo límite"})}),p&&e.jsx(e.Fragment,{children:e.jsx(T,{fullWidth:!0,margin:"normal",children:e.jsx(C,{id:"limit-time-required",label:"Tiempo límite (segundos por pregunta)",type:"number",onChange:o=>u(o.target.value),inputProps:{min:1}})})})]})}),e.jsxs(V,{children:[e.jsx(w,{onClick:()=>{d(),j(""),l("")},children:"Cancelar"}),e.jsx(w,{variant:"contained",onClick:G,disabled:!s,children:"Crear"})]})]}),e.jsxs(O,{open:q,onClose:()=>W(!1),children:[e.jsx(M,{children:"Existen preguntas asignadas a esta materia"}),e.jsx(B,{children:"Al continuar se reasignarán las nuevas preguntas a la materia con el nivel asignado. ¿Quieres continuar?"}),e.jsxs(V,{children:[e.jsx(w,{onClick:()=>W(!1),children:"Cancelar"}),e.jsx(w,{onClick:()=>{Q(!0),W(!1)},autoFocus:!0,children:"Continuar"})]})]})]})}function ze({open:g,onClose:d,types:n,onImport:a,handleExport:m}){const[s,j]=i.useState(""),[l,f]=i.useState(null),[t,r]=i.useState(""),[c,p]=i.useState(""),b=n.find(u=>u.id===Number(t)),_=(b==null?void 0:b.levels)||[],S=u=>{f(u.target.files[0])},I=()=>{if(l&&t){const u=new FormData;u.append("file",l),u.append("type_id",t),u.append("level_id",c),a(u),f(null),setTypetId(""),setLeveltId(""),d()}};return e.jsxs(O,{open:g,onClose:d,fullWidth:!0,maxWidth:"sm",children:[e.jsx(M,{children:"Importar a banco de preguntas"}),e.jsx(B,{children:e.jsxs(h,{sx:{mt:2},children:[e.jsxs(T,{fullWidth:!0,margin:"normal",children:[e.jsx(R,{id:"type-select-label",children:"Tipo de cuestionario"}),e.jsx(L,{labelId:"type-select-label",value:t,label:"Tipo de cuestionario",onChange:u=>{r(u.target.value),p("")},required:!0,children:n.filter(u=>u.is_automatic===0).map(u=>e.jsx(v,{value:u.id,children:u.name},u.id))})]}),e.jsxs(T,{fullWidth:!0,margin:"normal",disabled:!_.length,children:[e.jsx(R,{id:"level-select-label",children:"Nivel de complejidad"}),e.jsx(L,{labelId:"level-select-label",value:c,label:"Nivel de complejidad",onChange:u=>p(u.target.value),required:!0,children:_.map(u=>e.jsxs(v,{value:u.id,children:[u.name," - ",u.description]},u.id))})]}),e.jsxs(w,{variant:"outlined",component:"label",fullWidth:!0,sx:{mt:2},children:["Seleccionar archivo Excel",e.jsx("input",{type:"file",hidden:!0,accept:".xlsx, .xls",onChange:S})]}),l&&e.jsx(C,{label:"Archivo seleccionado",value:l.name,fullWidth:!0,disabled:!0,margin:"normal"})]})}),e.jsxs(V,{children:[e.jsx(w,{disabled:!t||!c,onClick:()=>{m(t,c),j(null)},children:"Exportar Concentrado"}),e.jsx(w,{onClick:()=>{d(),r(null),p(null)},children:"Cancelar"}),e.jsx(w,{variant:"contained",onClick:I,disabled:!l||!t,children:"Importar"})]})]})}function Me({open:g,onClose:d,type:n,handleSowQuestions:a}){const m=[{field:"name",headerName:"Nivel",flex:.1},{field:"description",headerName:"Descripción",flex:.5},{field:"actions",headerName:"Acciones",flex:.2,sortable:!1,renderCell:s=>e.jsx(J,{direction:"row",spacing:1,children:e.jsx(P,{title:"Ver preguntas",arrow:!0,children:e.jsx(k,{onClick:()=>a(s.row),color:"primary",children:e.jsx(se,{})})})})}];return e.jsxs(O,{open:g,onClose:d,fullWidth:!0,maxWidth:"md",children:[e.jsxs(M,{children:["Niveles de: ",n==null?void 0:n.name]}),e.jsx(B,{children:e.jsx(h,{sx:{height:400,width:"100%"},children:e.jsx(X,{rows:n==null?void 0:n.levels,columns:m,pageSize:5,rowsPerPageOptions:[5],getRowId:s=>s.id})})}),e.jsx(V,{children:e.jsx(w,{onClick:d,children:"Cerrar"})})]})}const Be=i.forwardRef(function(d,n){return e.jsx(Pe,{direction:"up",ref:n,...d})});function Ve({open:g,close:d,questions:n,type:a,handleEditQuestion:m}){const s=t=>{if(typeof t!="string")return!1;const r=t.trim().toLowerCase();return r.startsWith("data:image/")||/\.(png|jpe?g|gif|svg|webp)$/.test(r)},j=t=>t?t.startsWith("http")||t.startsWith("data:")?t:`undefined/${t}`:"",l=[{field:"name",headerName:"Memorama",flex:.9,sortable:!0,renderCell:t=>{const r=ve[t.row.name];return r?e.jsx(r,{sx:{fontSize:40,color:"#555",mx:"auto"}}):e.jsx("span",{children:t.row.name})}}],f=[{field:"question",headerName:"Pregunta",flex:.9,sortable:!0,renderCell:t=>t.row.question?e.jsx(P,{title:t.row.question,arrow:!0,children:e.jsx("span",{style:{cursor:"default"},children:t.row.question})}):e.jsx(h,{component:"img",src:t.row.question_image,alt:"Pregunta",sx:{width:300,height:"auto",objectFit:"contain"}})},{field:"answer_a",headerName:"Opción A",flex:.9,sortable:!0,renderCell:({row:t})=>{if(t.question){const c=t.answer_a??t.option_a??"";return e.jsx("span",{children:c||"-"})}const r=t.answer_a??t.option_a??"";return r?s(r)?e.jsx(h,{sx:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(h,{component:"img",src:j(r),alt:"Respuesta A",sx:{width:25,height:25,objectFit:"contain"}})}):e.jsx("span",{children:r}):e.jsx("span",{children:"-"})}},{field:"answer_b",headerName:"Opción B",flex:.9,sortable:!0,renderCell:({row:t})=>{if(t.question){const c=t.answer_b??t.option_b??"";return e.jsx("span",{children:c||"-"})}const r=t.answer_b??t.option_b??"";return r?s(r)?e.jsx(h,{sx:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(h,{component:"img",src:j(r),alt:"Respuesta B",sx:{width:25,height:25,objectFit:"contain"}})}):e.jsx("span",{children:r}):e.jsx("span",{children:"-"})}},{field:"answer_c",headerName:"Opción C",flex:.9,sortable:!0,renderCell:({row:t})=>{if(t.question){const c=t.answer_c??t.option_c??"";return e.jsx("span",{children:c||"-"})}const r=t.answer_c??t.option_c??"";return r?s(r)?e.jsx(h,{sx:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(h,{component:"img",src:j(r),alt:"Respuesta C",sx:{width:25,height:25,objectFit:"contain"}})}):e.jsx("span",{children:r}):e.jsx("span",{children:"-"})}},{field:"answer_d",headerName:"Opción D",flex:.9,sortable:!0,renderCell:({row:t})=>{if(t.question){const c=t.answer_d??t.option_d??"";return e.jsx("span",{children:c||"-"})}const r=t.answer_d??t.option_d??"";return r?s(r)?e.jsx(h,{sx:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(h,{component:"img",src:j(r),alt:"Respuesta D",sx:{width:25,height:25,objectFit:"contain"}})}):e.jsx("span",{children:r}):e.jsx("span",{children:"-"})}},{field:"correct_answer",headerName:"Respuesta",flex:.9,sortable:!0,renderCell:t=>e.jsx("span",{children:t.row.correct_answer??t.row.answer})},{field:"actions",headerName:"Acciones",flex:.5,sortable:!0,renderCell:t=>!t.row.q_hash||t.row.q_hash===""?e.jsx(J,{direction:"row",spacing:1,children:e.jsx(P,{title:"Editar",arrow:!0,children:e.jsx(k,{onClick:()=>m(t.row,a==null?void 0:a.name),color:"primary",children:e.jsx(ae,{})})})}):null}];return e.jsx(i.Fragment,{children:e.jsxs(O,{fullScreen:!0,open:g,onClose:d,slots:{transition:Be},children:[e.jsx(Ee,{sx:{position:"relative"},children:e.jsxs(Ne,{children:[e.jsx(k,{edge:"start",color:"inherit",onClick:d,"aria-label":"close",children:e.jsx($,{})}),e.jsx(A,{sx:{ml:2,flex:1},variant:"h6",component:"div",children:a==null?void 0:a.name}),e.jsx(w,{autoFocus:!0,color:"inherit",onClick:d,children:"CERRAR"})]})}),e.jsx(h,{p:4,children:e.jsx(h,{sx:{height:500,width:"100%"},children:e.jsx(X,{rows:n,columns:(a==null?void 0:a.bypass_levels_and_questions)!=1?f:l,pageSize:10,rowsPerPageOptions:[5,10,20],disableSelectionOnClick:!0,autoHeight:!0})})})]})})}function $e({open:g,onClose:d,levels:n=[],onChange:a}){const[m,s]=i.useState([]);i.useEffect(()=>{s(n||[])},[n]);const j=(t,r,c)=>{const p=[...m];p[t][r]=c,s(p),a(p)},l=()=>{const t={id:`new-${Date.now()}`,name:"",description:"",question_type_id:1},r=[...m,t];s(r),a(r)},f=t=>{if(m.length<=1)return;const r=[...m];r.splice(t,1),s(r),a(r)};return e.jsxs(O,{open:g,onClose:d,fullWidth:!0,maxWidth:"sm",slotProps:{backdrop:{sx:{zIndex:t=>t.zIndex.drawer+2001}}},PaperProps:{sx:{zIndex:t=>t.zIndex.drawer+2002}},children:[e.jsx(M,{children:"Editar Niveles"}),e.jsxs(B,{dividers:!0,children:[m.length===0&&e.jsx(A,{variant:"body2",sx:{mt:1},children:"No hay niveles registrados."}),m.map((t,r)=>e.jsxs(h,{sx:{mt:2},children:[r!==0&&e.jsx(Ae,{sx:{my:2}}),e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(A,{variant:"subtitle1",children:"NIVEL"}),e.jsx(k,{color:"error",onClick:()=>f(r),disabled:m.length<=1,children:e.jsx(Ie,{})})]}),e.jsx(C,{label:"Nombre",fullWidth:!0,value:t.name,onChange:c=>j(r,"name",c.target.value),sx:{mb:1}}),e.jsx(C,{label:"Descripción",fullWidth:!0,value:t.description,onChange:c=>j(r,"description",c.target.value)})]},t.id||r)),e.jsx(w,{variant:"outlined",onClick:l,sx:{mt:3},children:"Agregar nivel"})]}),e.jsx(V,{children:e.jsx(w,{onClick:d,children:"Cerrar"})})]})}function qe({open:g,onClose:d,type:n=null,onSubmit:a}){const[m,s]=i.useState(!1),[j,l]=i.useState([]),[f,t]=i.useState({type_id:"",name:"",description:""});i.useEffect(()=>{n?(t({type_id:n.id||"",name:n.name||"",description:n.description||""}),l(n.levels||[])):(t({type_id:(n==null?void 0:n.id)||"",name:"",description:""}),l([]))},[n]);const r=p=>{const{name:b,value:_}=p.target;t(S=>({...S,[b]:_}))},c=p=>{p.preventDefault();const b={...f,levels:j};a(b),d()};return e.jsxs(e.Fragment,{children:[e.jsx(H,{anchor:"right",open:g,onClose:d,sx:{zIndex:p=>p.zIndex.drawer+10},children:e.jsxs(h,{sx:{width:400,p:3},role:"presentation",children:[e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(A,{variant:"h6",children:n?"Editar tipo de cuestionario":"Nuevo tipo de cuestionario"}),e.jsx(k,{onClick:d,children:e.jsx($,{})})]}),e.jsxs(h,{component:"form",onSubmit:c,mt:2,children:[e.jsx(C,{label:"Nombre",name:"name",fullWidth:!0,value:f.name,onChange:r,required:!0}),e.jsx(C,{label:"Descripción",name:"description",fullWidth:!0,value:f.description,onChange:r,margin:"normal",required:!0}),e.jsx(w,{type:"button",variant:"text",color:"secondary",fullWidth:!0,sx:{mt:2},onClick:()=>s(!0),children:"Editar niveles"}),e.jsx(w,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},children:n?"Actualizar":"Crear"})]})]})}),e.jsx($e,{open:m,onClose:()=>s(!1),levels:j,onChange:l})]})}function kn(){var ne,te;const{errors:g,flash:d}=K().props,{subjects:n,types:a}=K().props,[m,s]=i.useState(!1),[j,l]=i.useState(!1),[f,t]=i.useState(!1),[r,c]=i.useState(!1),[p,b]=i.useState(null),[_,S]=i.useState(null),[I,u]=i.useState(null),D=((te=(ne=K().props)==null?void 0:ne.flash)==null?void 0:te.success)??null,[q,W]=i.useState(!!D),[U,Q]=i.useState(!1),[G,o]=i.useState([]),[z,F]=i.useState(!1),[ie,Y]=i.useState(!1),[le,Z]=i.useState(null),[oe,E]=i.useState(!1);i.useEffect(()=>{D&&W(!0)},[D]),i.useEffect(()=>{Object.keys(g).length>0&&Q(!0)},[g]);const ce=x=>{u(x),t(!0)},de=(x,N)=>{b(x),s(!0),N=="MULTITASKING"?Z("MULTITASKING"):Z("SINGLE")},ue=x=>{u(x),l(!0)},ee=()=>{s(!1),b(null),S(null)},he=()=>{t(!1),b(null),S(null)},me=()=>{l(!1),b(null),S(null)},xe=()=>{c(!0)},pe=(x,N)=>{E(!0),y.Inertia.get(route("question.export",{typeId:x,levelId:N}),{},{onFinish:()=>E(!1),onError:()=>E(!1)})},fe=x=>{u(x),Y(!0)},je=[{field:"name",headerName:"Tipo de cuestionario",flex:.5},{field:"description",headerName:"Descripción",flex:.5},{field:"actions",headerName:"Acciones",flex:.5,sortable:!0,renderCell:x=>e.jsxs(J,{direction:"row",spacing:1,children:[e.jsx(P,{title:"Niveles",arrow:!0,children:e.jsx(k,{onClick:()=>ue(x.row),color:"primary",children:e.jsx(se,{})})}),e.jsx(P,{title:"Asignar a Materias",arrow:!0,children:e.jsx(k,{onClick:()=>ce(x.row),color:"primary",children:e.jsx(_e,{})})}),e.jsx(P,{title:"Asignar a Materias",arrow:!0,children:e.jsx(k,{onClick:()=>fe(x.row),color:"primary",children:e.jsx(ae,{})})})]})}],ge=x=>{E(!0),y.Inertia.post(route("question.test"),x,{forceFormData:!0,onFinish:()=>{console.log("termino de guardar"),E(!1)}})},be=async x=>{try{E(!0);const N=await re.get(route("question.show",{typeId:I==null?void 0:I.id,levelId:x==null?void 0:x.id}));N.data.questions&&(o(N.data.questions),F(!0),E(!1))}catch(N){console.error("Error al obtener preguntas:",N)}},Ce=x=>{y.Inertia.put(route("type.update",x.type_id),x)};return e.jsxs(Se,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Cuestionarios"}),children:[e.jsx(we,{title:"Cuestionarios"}),e.jsx(Le,{open:q,onClose:()=>W(!1),message:D}),e.jsx(ye,{open:U,onClose:()=>Q(!1),errors:g}),e.jsxs(h,{p:4,children:[e.jsx(h,{display:"flex",justifyContent:"flex-end",mb:2,children:e.jsx(w,{variant:"contained",color:"primary",onClick:xe,children:"Importar Cuestionario"})}),e.jsx(h,{sx:{height:500,width:"100%"},children:e.jsx(X,{rows:a,columns:je,pageSize:10,rowsPerPageOptions:[5,10,20],disableSelectionOnClick:!0,autoHeight:!0})})]}),e.jsx(ke,{open:oe,sx:{color:"#fff",zIndex:x=>x.zIndex.modal+1},children:e.jsx(De,{color:"inherit"})}),le=="MULTITASKING"?e.jsx(Oe,{open:m,onClose:ee,question:p}):e.jsx(Re,{open:m,onClose:ee,question:p}),e.jsx(Qe,{open:f,onClose:he,subjects:n,type:I,onSave:ge}),e.jsx(Me,{open:j,onClose:me,type:I,handleSowQuestions:be}),e.jsx(Ve,{open:z,close:()=>F(!1),questions:G,type:I,handleEditQuestion:de}),e.jsx(ze,{open:r,onClose:()=>c(!1),types:a,onImport:x=>{E(!0),y.Inertia.post(route("question.import"),x,{forceFormData:!0,onFinish:()=>{console.log("termino de guardar"),E(!1)}})},handleExport:pe}),e.jsx(qe,{open:ie,onClose:()=>Y(!1),type:I,onSubmit:Ce})]})}export{kn as default};
